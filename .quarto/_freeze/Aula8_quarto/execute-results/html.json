{
  "hash": "99a1a6d99700c1e6d449f8b6eca863fd",
  "result": {
    "markdown": "---\ntitle: \"ANOVA em blocos casualizados e parcela subdividida\"\nformat: html\nmessage: false\nwarning: false\n---\n\n\n# ANOVA em blocos casualizados\n\nO delineamento em blocos casualizado (DBC) envolve os três princípios da experimentação: repetição, casualização e controle local. Neste caso, as condições locais não são homogêneas e podem ter efeito significativo sobre os tratamentos, sendo necessário o uso de blocos para controlar uma variação conhecida do ambiente.\n\nAssim, a ANOVA contará com três fontes de variação: duas fontes de variação conhecidas (tratamento e bloco), e uma fonte de variação desconhecida (resíduo).\n\nVale destacar que no DBC não há interesse pela interação do bloco com o tratamento, sendo o bloco apenas para controlar uma possível variação sobre os tratamentos induzida por uma possível variação do ambiente.\n\n## Importação dos dados\n\nO conjunto de dados foi importado do Google Sheet através da função `gsheet2tbl()` do pacote `gsheet`.\n\nOs dados importados contam com três variáveis respostas: DFC, Ferrugem e Produtividade. Foram experimentados 8 tratamentos, com 4 blocos.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(gsheet)\n\nsoja <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=866852711\")\n```\n:::\n\n\nPara cada variável resposta será feito uma ANOVA. Mas primeiro é necessário considerar o número dos tratamentos e os números dos blocos como fatores. Isso pode ser feito usando a função `mutate()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsoja <- soja |> \n  mutate(TRAT = as.factor(TRAT),\n         BLOCO = as.factor(BLOCO))\n```\n:::\n\n\n## Visualização dos dados\n\nPara cada variável resposta foi criado um gráfico de pontos com a média e o intervalo de confiança de cada tratamento. O gráfico foi feito usando as funções `ggplot()`, `geom_jitter()` e `stat_summary()`, com o argumento `fun.data = \"mean_cl_boot\"` (esse argumento cria a bola representando a média e as linhas representando o intervalo de confiança)\n\nDepois, os 3 gráficos foram colocados juntos através do pacote `patchwork`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndfc <- soja |> \n  ggplot(aes(TRAT, DFC))+\n  geom_jitter(width = 0.1, color = \"gray70\")+\n  stat_summary(fun.data = \"mean_cl_boot\", color = \"black\")\ndfc\n```\n\n::: {.cell-output-display}\n![](Aula8_quarto_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\nfer <- soja |> \n  ggplot(aes(TRAT, FER))+\n  geom_jitter(width = 0.1, color = \"gray70\")+\n  stat_summary(fun.data = \"mean_cl_boot\", color = \"blue\")\nfer\n```\n\n::: {.cell-output-display}\n![](Aula8_quarto_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n\n```{.r .cell-code}\nprod <- soja |> \n  ggplot(aes(TRAT, PROD))+\n  geom_jitter(width = 0.1, color = \"gray70\")+\n  stat_summary(fun.data = \"mean_cl_boot\", color = \"red\")\nprod\n```\n\n::: {.cell-output-display}\n![](Aula8_quarto_files/figure-html/unnamed-chunk-3-3.png){width=672}\n:::\n\n```{.r .cell-code}\nlibrary(patchwork)\ndfc / fer / prod\n```\n\n::: {.cell-output-display}\n![](Aula8_quarto_files/figure-html/unnamed-chunk-3-4.png){width=672}\n:::\n:::\n\n\n## ANOVA DFC\n\nComo não há interesse da interação entre o bloco e o tratamento, é preciso ajustar o modelo linear de modo que o bloco seja considerado como efeito fixo. Isso pode ser feito usando a função `lm()` juntamente com a fórmula `DFC ~ TRAT+BLOCO` (o \"+\" garante que o BLOCO seja visto como efeito fixo)\n\n\n::: {.cell}\n\n```{.r .cell-code}\naov_dfc <- lm(DFC ~ TRAT+BLOCO,\n              data = soja)\n```\n:::\n\n\nCom o modelo ajustado, é executado a ANOVA usando a função `anova()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(aov_dfc)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: DFC\n          Df  Sum Sq Mean Sq F value    Pr(>F)    \nTRAT       7 149.299 21.3284 51.5490 8.218e-12 ***\nBLOCO      3   0.461  0.1537  0.3716    0.7743    \nResiduals 21   8.689  0.4138                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nPelo resultado da ANOVA, pode-se observar que o efeito dos tratamentos na váriavel DFC é significativo, enquanto que o efeito dos blocos não é significativo.\n\n### Teste das premissas\n\nAs premissas foram checadas através das funções `check_heteroscedasticity()` e `check_normality()`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(performance)\ncheck_heteroscedasticity(aov_dfc)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.532).\n```\n:::\n\n```{.r .cell-code}\ncheck_normality(aov_dfc)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.978).\n```\n:::\n:::\n\n\nAmbas as premissas foram atendidas\n\n### Comparação das médias entre os grupos\n\nA comparação das médias entre os grupos foi realizada com as funções `emmeans()` e `cld`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(emmeans)\nmedias_dfc <- emmeans(aov_dfc, ~ TRAT)\n\nlibrary(multcomp)\nlibrary(multcompView)\ncld(medias_dfc, Letters = letters)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n TRAT emmean    SE df lower.CL upper.CL .group\n 6      4.00 0.322 21     3.33     4.67  a    \n 7      4.08 0.322 21     3.41     4.74  a    \n 5      4.20 0.322 21     3.53     4.87  a    \n 8      4.58 0.322 21     3.91     5.24  ab   \n 4      4.75 0.322 21     4.08     5.42  ab   \n 3      6.05 0.322 21     5.38     6.72   bc  \n 2      6.42 0.322 21     5.76     7.09    c  \n 1     10.88 0.322 21    10.21    11.54     d \n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 8 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n\nObserva-se a formação de 4 grupos estatisticamente distintos.\n\nA eficácia no controle do DFC pode ser calculado através da seguinte fórmula: Eficácia no controle (%) = (1- (emmean do tratamento/emmean da testemunha))\\*100\n\n## ANOVA FER\n\n\n::: {.cell}\n\n```{.r .cell-code}\naov_fer <- lm(FER ~ TRAT+BLOCO,\n              data = soja)\nanova(aov_fer)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: FER\n          Df Sum Sq Mean Sq F value    Pr(>F)    \nTRAT       7 978.87 139.838 55.1717 4.218e-12 ***\nBLOCO      3   3.84   1.279  0.5045    0.6834    \nResiduals 21  53.23   2.535                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n### Teste das premissas\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_heteroscedasticity(aov_fer)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWarning: Heteroscedasticity (non-constant error variance) detected (p < .001).\n```\n:::\n\n```{.r .cell-code}\ncheck_normality(aov_fer)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWarning: Non-normality of residuals detected (p = 0.008).\n```\n:::\n:::\n\n\nAmbas as premissas não foram atendidas.\n\n### Transformação dos dados por Boxcox\n\n\n::: {.cell}\n\n```{.r .cell-code}\nb <- boxcox(lm(soja$FER ~ 1))\n```\n\n::: {.cell-output-display}\n![](Aula8_quarto_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\nlambda <- b$x[which.max(b$y)]\nlambda\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -1.555556\n```\n:::\n\n```{.r .cell-code}\nsoja$FER3 <- (soja$FER ^ lambda - 1)/ lambda\n```\n:::\n\n\n### Nova ANOVA com os dados transformados\n\n\n::: {.cell}\n\n```{.r .cell-code}\naov_fer3 <- lm(FER3 ~ TRAT+BLOCO,\n              data = soja)\nanova(aov_fer3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: FER3\n          Df   Sum Sq   Mean Sq F value    Pr(>F)    \nTRAT       7 0.041641 0.0059488 12.9020 2.436e-06 ***\nBLOCO      3 0.005895 0.0019649  4.2616   0.01687 *  \nResiduals 21 0.009683 0.0004611                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nCom os dados transformados, nota-se que o efeito dos blocos também é significante para variável resposta da ferrugem.\n\n### Nova checagem das premissas\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_normality(aov_fer3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.787).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(aov_fer3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.872).\n```\n:::\n:::\n\n\n### Comparação das médias entre os grupos\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmedias_fer2 <- emmeans(aov_fer3, ~ TRAT)\nmedias_fer2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n TRAT emmean     SE df lower.CL upper.CL\n 1     0.637 0.0107 21    0.614    0.659\n 2     0.596 0.0107 21    0.574    0.618\n 3     0.553 0.0107 21    0.530    0.575\n 4     0.527 0.0107 21    0.505    0.550\n 5     0.539 0.0107 21    0.517    0.561\n 6     0.523 0.0107 21    0.501    0.545\n 7     0.545 0.0107 21    0.523    0.567\n 8     0.549 0.0107 21    0.527    0.572\n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \n```\n:::\n\n```{.r .cell-code}\npwpm(medias_fer2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n         1        2        3        4        5        6        7       8\n1  [0.637]   0.1857   0.0004   <.0001   <.0001   <.0001   0.0001  0.0002\n2  0.04058  [0.596]   0.1358   0.0039   0.0208   0.0020   0.0497  0.0880\n3  0.08380  0.04322  [0.553]   0.7032   0.9807   0.5313   0.9995  1.0000\n4  0.10920  0.06862  0.02540  [0.527]   0.9938   1.0000   0.9339  0.8261\n5  0.09775  0.05717  0.01395 -0.01145  [0.539]   0.9629   0.9999  0.9964\n6  0.11349  0.07292  0.02970  0.00429  0.01575  [0.523]   0.8261  0.6703\n7  0.09154  0.05097  0.00775 -0.01766 -0.00620 -0.02195  [0.545]  1.0000\n8  0.08725  0.04667  0.00345 -0.02195 -0.01050 -0.02624 -0.00429 [0.549]\n\nRow and column labels: TRAT\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n```\n:::\n\n```{.r .cell-code}\ncld(medias_fer2, Letters = letters)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n TRAT emmean     SE df lower.CL upper.CL .group\n 6     0.523 0.0107 21    0.501    0.545  a    \n 4     0.527 0.0107 21    0.505    0.550  a    \n 5     0.539 0.0107 21    0.517    0.561  a    \n 7     0.545 0.0107 21    0.523    0.567  a    \n 8     0.549 0.0107 21    0.527    0.572  ab   \n 3     0.553 0.0107 21    0.530    0.575  ab   \n 2     0.596 0.0107 21    0.574    0.618   bc  \n 1     0.637 0.0107 21    0.614    0.659    c  \n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 8 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n\nObserva-se a formação de 3 grupos estatisticamente distintos.\n\n## ANOVA PROD\n\n\n::: {.cell}\n\n```{.r .cell-code}\naov_prod <- lm(PROD ~ TRAT+BLOCO,\n              data = soja)\nanova(aov_prod)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: PROD\n          Df  Sum Sq Mean Sq F value  Pr(>F)  \nTRAT       7 2993906  427701  2.6367 0.04021 *\nBLOCO      3  105665   35222  0.2171 0.88340  \nResiduals 21 3406431  162211                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n### Teste das premissas\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_heteroscedasticity(aov_prod)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.215).\n```\n:::\n\n```{.r .cell-code}\ncheck_normality(aov_prod)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.542).\n```\n:::\n:::\n\n\nAmbas as premissas foram atendidas\n\n### Comparação das médias entre os grupos\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmedias_prod <- emmeans(aov_prod, ~ TRAT)\nmedias_prod\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n TRAT emmean  SE df lower.CL upper.CL\n 1      4219 201 21     3800     4638\n 2      4935 201 21     4516     5354\n 3      5110 201 21     4691     5529\n 4      5140 201 21     4721     5559\n 5      5122 201 21     4703     5541\n 6      5256 201 21     4837     5675\n 7      5128 201 21     4709     5546\n 8      5078 201 21     4659     5497\n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \n```\n:::\n\n```{.r .cell-code}\npwpm(medias_prod)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        1       2       3       4       5       6       7      8\n1  [4219]  0.2430  0.0792  0.0640  0.0728  0.0272  0.0700 0.0985\n2  -715.8  [4935]  0.9983  0.9953  0.9974  0.9430  0.9968 0.9995\n3  -890.8  -175.0  [5110]  1.0000  1.0000  0.9994  1.0000 1.0000\n4  -921.0  -205.3   -30.3  [5140]  1.0000  0.9999  1.0000 1.0000\n5  -902.8  -187.0   -12.0    18.3  [5122]  0.9997  1.0000 1.0000\n6 -1037.0  -321.3  -146.3  -116.0  -134.3  [5256]  0.9998 0.9981\n7  -908.3  -192.5   -17.5    12.8    -5.5   128.8  [5127] 1.0000\n8  -859.0  -143.3    31.7    62.0    43.7   178.0    49.2 [5078]\n\nRow and column labels: TRAT\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n```\n:::\n\n```{.r .cell-code}\ncld(medias_prod, Letters = letters)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n TRAT emmean  SE df lower.CL upper.CL .group\n 1      4219 201 21     3800     4638  a    \n 2      4935 201 21     4516     5354  ab   \n 8      5078 201 21     4659     5497  ab   \n 3      5110 201 21     4691     5529  ab   \n 5      5122 201 21     4703     5541  ab   \n 7      5128 201 21     4709     5546  ab   \n 4      5140 201 21     4721     5559  ab   \n 6      5256 201 21     4837     5675   b   \n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 8 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n\nObserva-se a formação de 2 grupos estatisticamente distintos.\n\nA diferença de produtividade pode ser calculada pela seguinte fórmula: Diferença de produtividade = emmean do tratamento - emmean da testemunha\n\n### Outra forma de visualizar os valores da produtividade\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmedias_prod_grupo <- cld(medias_prod, Letters = letters)\ndf_prod <- data.frame(medias_prod_grupo)\ndf_prod |> \n  ggplot(aes(TRAT, emmean))+\n  geom_point()+\n  ylim(3000,6500)+\n  geom_errorbar(aes(min = lower.CL,\n                    max = upper.CL),\n                width = 0.1)+\n  annotate(geom = \"text\", x = 1.2, y = 4200, label = \"A\")+\n  annotate(geom = \"text\", x = 2.3, y = 5000, label = \"AB\")\n```\n\n::: {.cell-output-display}\n![](Aula8_quarto_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n### Exportando a tabela de comparação das médias entre os grupos\n\nUsando a função `write_xlsx()` do pacote `writexl`, é possível exportar a tabela de comparação das médias entre os grupos para um arquivo Excel.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::kable(df_prod |> dplyr::select(TRAT, emmean, .group))\n```\n\n::: {.cell-output-display}\n|   |TRAT |  emmean|.group |\n|:--|:----|-------:|:------|\n|1  |1    | 4219.25|a      |\n|2  |2    | 4935.00|ab     |\n|8  |8    | 5078.25|ab     |\n|3  |3    | 5110.00|ab     |\n|5  |5    | 5122.00|ab     |\n|7  |7    | 5127.50|ab     |\n|4  |4    | 5140.25|ab     |\n|6  |6    | 5256.25|b      |\n:::\n\n```{.r .cell-code}\nlibrary(writexl)\nwrite_xlsx(df_prod, \"df.xlsx\")\n```\n:::\n\n\n# ANOVA da área abaixo da curva de progresso da doença\n\nA área abaixo da curva de progresso da doença (AACPD) é um parâmetro quantitativo muito utilizado em diversos patossistemas na análise do progresso das doenças em plantas, o seu valor é obtido após uma série de avaliações de severidade ao longo do tempo.\n\n## Importação dos dados\n\nO conjunto de dados foi importado a partir do Google Sheet através da função `gsheet2tbl()` do pacote `gsheet`. Como os dados não estavam no formato de data frame, foi usado a função `as.data.frame()` para realizar a conversão.\n\nO conjunto de dados apresenta a severidade de uma doença em função do dia e do modo de irrigação.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncurve <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=1807247585\")\ncurve = as.data.frame(curve)\n```\n:::\n\n\n## Visualização dos dados\n\nPor ser um conjunto de dados que possui uma variável numérica em função de um fator temporal, foi construído um gráfico de linhas para exibir o progresso da severidade da doença em função dos dias. Para isso, foi usado as funções `ggplot()` juntamente a `geom_point()` e `geom_line()`.\n\nTambém foram feitos gráficos separando os dados em função dos diferentes modos de irrigação utilizados no experimento.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncurve |> \n  group_by(day) |> \n  summarise(severity_mean = mean(severity),\n            severity_sd = sd(severity)) |> \n  ggplot(aes(day, severity_mean))+\n  geom_point(width = 0.05)+\n  geom_line()\n```\n\n::: {.cell-output-display}\n![](Aula8_quarto_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n\n```{.r .cell-code}\ncurve |> \n  group_by(day, Irrigation) |> \n  summarise(severity_mean = mean(severity),\n            severity_sd = sd(severity)) |> \n  ggplot(aes(day, severity_mean, color = Irrigation))+\n  geom_point(width = 0.05)+\n  geom_line()\n```\n\n::: {.cell-output-display}\n![](Aula8_quarto_files/figure-html/unnamed-chunk-20-2.png){width=672}\n:::\n\n```{.r .cell-code}\ncurve |> \n  group_by(day, Irrigation) |> \n  summarise(severity_mean = mean(severity)) |> \n  ggplot(aes(day, severity_mean))+\n  geom_point(width = 0.05)+\n  geom_line()+\n  facet_grid(~Irrigation)\n```\n\n::: {.cell-output-display}\n![](Aula8_quarto_files/figure-html/unnamed-chunk-20-3.png){width=672}\n:::\n:::\n\n\n## AUDPC\n\nPara calcular a AUDPC (o mesmo que AACPD), foi usado o pacote `epifitter` junto com a função `summarise(AUDPC())`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(epifitter)\naudpc <- curve |> \n  group_by(Irrigation, rep) |> \n  summarise(aacpd = AUDPC(day, severity))\n```\n:::\n\n\n## ANOVA da AUDPC\n\nTendo os dados da AUDPC, o conjunto de dados foi ajustado para o modelo linear usando a função `lm()` e a fórmula `aacpd ~ Irrigation + factor(rep)`, na qual as repetições foram considerados como efeito fixo.\n\nPosteriormente, foi realizado uma análise de variância.\n\n\n::: {.cell}\n\n```{.r .cell-code}\naov_audpc <- lm(aacpd ~ Irrigation + factor(rep),\n                data = audpc) \nanova(aov_audpc)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: aacpd\n            Df  Sum Sq  Mean Sq F value  Pr(>F)  \nIrrigation   1 0.23602 0.236017  10.605 0.08275 .\nfactor(rep)  2 0.61291 0.306454  13.771 0.06770 .\nResiduals    2 0.04451 0.022254                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nPelos resultados, percebe-se que tanto o modo de irrigação quanto as repetições tiveram efeitos pouco significativos em relação ao AUDPC.\n\nUsando os dados originais importados, foi também realizado uma ANOVA da severidade da doença em função do modo de irrigação interagindo com o fator dia, com as repetições novamente como efeito fixo.\n\n\n::: {.cell}\n\n```{.r .cell-code}\naov_curve <- lm(severity ~ Irrigation*day + rep,\n         data = curve)\nanova(aov_curve)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: severity\n               Df  Sum Sq Mean Sq   F value Pr(>F)    \nIrrigation      1 0.00067 0.00067    0.5419 0.4648    \nday             1 1.33121 1.33121 1082.0680 <2e-16 ***\nrep             1 0.00009 0.00009    0.0732 0.7878    \nIrrigation:day  1 0.00070 0.00070    0.5716 0.4528    \nResiduals      55 0.06766 0.00123                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nObserva-se que o fator dia teve um efeito significativo sobre a severidade da doença, enquanto que os outros componentes não tiveram efeitos sobre a variável.\n\n### Coeficiente de variação\n\nO coeficiente de variação (CV) é um indicador da variabilidade de um conjunto de dados. Ele pode ser encontrado usando a função `cv.model()` do pacote `agricolae`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(agricolae)\ncv.model(aov_audpc)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.097572\n```\n:::\n:::\n\n\n# Parcela subdividida\n\nNo delineamento em parcelas subdivididas existem dois tipos de tratamento: o principal e o secundário. As parcelas são subdivididas no espaço, ou no tempo. Depois que os tratamentos principais (parcelas) são sorteados, sorteia-se o tratamento secundário (subparcelas) dentro das parcelas.\n\nOs tratamentos primários são distribuídos às parcelas de acordo com um delineamento especificado (efeito fixo).\n\nOs tratamentos secundários são distribuídos às subparcelas de forma aleatória (efeito aleatório).\n\nDesse modo, em delineamento de parcela subdivida é trabalhado um modelo misto: fator fixo + fator aleatório.\n\n## Importação dos dados\n\nO conjunto de dados foi importado a partir do Google Sheet através da função `gsheet2tbl()` do pacote `gsheet`.\n\nEsses dados representam podridão de Fusarium em milho em parcelas subdivididas. Dentro de cada bloco foi casualizado os híbridos (tratamento primário). O método de aplicação foi casualizado dentro dos híbridos (tratamento secundário).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmilho <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=1345524759\")\n```\n:::\n\n\n## Visualização dos dados\n\nForam criados dois gráficos de pontos com intervalos de confiança, sendo um gráfico sobre o índice e outro sobre a produtividade. Os gráficos foram criados usando as funções `ggplot()`, `geom_jitter()` e `stat_summary` (para criar os pontos médios e intervalos de confiança)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmilho |> \n  ggplot(aes(method, index))+\n  geom_jitter(width = 0.1, color = \"black\", alpha = 0.2)+\n  facet_grid(~hybrid)+\n  stat_summary(fun.data = \"mean_cl_boot\", color = \"blue\")\n```\n\n::: {.cell-output-display}\n![](Aula8_quarto_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n\n```{.r .cell-code}\nmilho |> \n  ggplot(aes(method, yield))+\n  geom_jitter(width = 0.1, color = \"black\", alpha = 0.2)+\n  facet_grid(~hybrid)+\n  stat_summary(fun.data = \"mean_cl_boot\", color = \"red\")\n```\n\n::: {.cell-output-display}\n![](Aula8_quarto_files/figure-html/unnamed-chunk-26-2.png){width=672}\n:::\n:::\n\n\n## Modelo para parcela subdividida - index\n\nEm relação à variável resposta de índice, o modelo do conjunto de dados foi ajustado para o modelo misto usando a função `lmer()` do pacote `lme4`. Para atribuir os efeitos fixos e aleatórios, foi usado a seguinte fórmula: `index ~ hybrid*method + block + (1|block/hybrid)`, no qual os blocos estão como efeitos fixos e os híbridos como efeitos aleatórios.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lme4)\n\nmilho <- milho |> \n  mutate(block = as.factor(block))\n\nmix <- lmer(index ~ hybrid*method + block + (1|block/hybrid), \n             data = milho)\n```\n:::\n\n\nA análise de variância foi executada com a função `Anova()` do pacote `car`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(car)\nAnova(mix)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: index\n                Chisq Df Pr(>Chisq)   \nhybrid        15.5971  5   0.008094 **\nmethod         4.6963  1   0.030228 * \nblock          0.2157  3   0.975023   \nhybrid:method 15.8060  5   0.007420 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nPode-se concluir que pelo menos um híbrido é diferente dos demais, assim como existe diferença significativa entre os métodos. A interação entre híbridos e métodos também resultou em uma diferença estatística.\n\n### Teste das premissas\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_normality(mix)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.635).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(mix)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWarning: Heteroscedasticity (non-constant error variance) detected (p = 0.009).\n```\n:::\n\n```{.r .cell-code}\nlibrary(DHARMa)\nplot(simulateResiduals(mix))\n```\n\n::: {.cell-output-display}\n![](Aula8_quarto_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\n\nA premissa da homocedasticidade não foi atendida, sendo necessário realizar transformação dos dados.\n\n### Transformação com raiz quadrada\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmix2 <- lmer(sqrt(index) ~ hybrid*method + block + (1|block/hybrid), \n             data = milho)\nAnova(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: sqrt(index)\n                Chisq Df Pr(>Chisq)   \nhybrid        15.3159  5   0.009095 **\nmethod         3.8886  1   0.048615 * \nblock          0.0783  3   0.994305   \nhybrid:method 13.3812  5   0.020057 * \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\ncheck_normality(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.440).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.970).\n```\n:::\n\n```{.r .cell-code}\nplot(simulateResiduals(mix2))\n```\n\n::: {.cell-output-display}\n![](Aula8_quarto_files/figure-html/unnamed-chunk-30-1.png){width=672}\n:::\n\n```{.r .cell-code}\nqqnorm(residuals(mix2))\nqqline(residuals(mix2))\n```\n\n::: {.cell-output-display}\n![](Aula8_quarto_files/figure-html/unnamed-chunk-30-2.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(residuals(mix2))\n```\n\n::: {.cell-output-display}\n![](Aula8_quarto_files/figure-html/unnamed-chunk-30-3.png){width=672}\n:::\n:::\n\n\nDessa vez as premissas foram atendidas.\n\n### Comparação das médias entre os grupos\n\nO teste de comparação das médias entre os grupos foi realizado com as funções `emmeans()` e `cld()`.\n\nComo a interação entre híbridos e métodos deu um valor significativo, o teste de comparação das médias foi tanta sobre os híbridos em função dos métodos, quando dos métodos em função dos híbridos.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmedias_milho <- emmeans(mix2,\n                        ~hybrid|method,\n                        type = \"response\") #Qaundo transforma dados, precisa colocar type = response\nmedias_milho2 <- emmeans(mix2,\n                         ~method|hybrid,\n                         type = \"response\")\n\ncld(medias_milho, Letters = LETTERS)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nmethod = pin:\n hybrid   response   SE   df lower.CL upper.CL .group\n BG7049H      19.4 10.3 5155     4.50     44.7  A    \n 30K64        20.3 10.5 5155     4.93     46.1  A    \n 30F53 YH     24.5 11.5 5155     7.11     52.3  AB   \n 30F53 HX     25.0 11.6 5155     7.35     53.0  AB   \n 30S31YH      31.7 13.1 5155    11.20     62.6  AB   \n 30S31H       37.1 14.2 5155    14.52     70.2   B   \n\nmethod = silk:\n hybrid   response   SE   df lower.CL upper.CL .group\n BG7049H      19.1 10.2 5155     4.35     44.3  A    \n 30K64        21.3 10.8 5155     5.44     47.6  A    \n 30F53 HX     24.4 11.5 5155     7.07     52.2  A    \n 30F53 YH     26.0 11.9 5155     7.95     54.6  A    \n 30S31H       26.3 12.0 5155     8.11     55.0  A    \n 30S31YH      26.4 12.0 5155     8.16     55.1  A    \n\nResults are averaged over the levels of: block \nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nIntervals are back-transformed from the sqrt scale \nNote: contrasts are still on the sqrt scale \nP value adjustment: tukey method for comparing a family of 6 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n\n```{.r .cell-code}\ncld(medias_milho2, Letters = letters)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nhybrid = 30F53 HX:\n method response   SE   df lower.CL upper.CL .group\n silk       24.4 11.5 5155     7.07     52.2  a    \n pin        25.0 11.6 5155     7.35     53.0  a    \n\nhybrid = 30F53 YH:\n method response   SE   df lower.CL upper.CL .group\n pin        24.5 11.5 5155     7.11     52.3  a    \n silk       26.0 11.9 5155     7.95     54.6  a    \n\nhybrid = 30K64:\n method response   SE   df lower.CL upper.CL .group\n pin        20.3 10.5 5155     4.93     46.1  a    \n silk       21.3 10.8 5155     5.44     47.6  a    \n\nhybrid = 30S31H:\n method response   SE   df lower.CL upper.CL .group\n silk       26.3 12.0 5155     8.11     55.0  a    \n pin        37.1 14.2 5155    14.52     70.2   b   \n\nhybrid = 30S31YH:\n method response   SE   df lower.CL upper.CL .group\n silk       26.4 12.0 5155     8.16     55.1  a    \n pin        31.7 13.1 5155    11.20     62.6  a    \n\nhybrid = BG7049H:\n method response   SE   df lower.CL upper.CL .group\n silk       19.1 10.2 5155     4.35     44.3  a    \n pin        19.4 10.3 5155     4.50     44.7  a    \n\nResults are averaged over the levels of: block \nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nIntervals are back-transformed from the sqrt scale \nNote: contrasts are still on the sqrt scale \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n\n## Modelo para parcela subdividida - yield\n\nOs mesmos processos foram repetidos para a variável resposta produtividade.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmix3 <- lmer(sqrt(yield) ~ hybrid*method + block + (1|block/hybrid), \n             data = milho)\nAnova(mix3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: sqrt(yield)\n                Chisq Df Pr(>Chisq)    \nhybrid        25.5591  5  0.0001086 ***\nmethod         0.0520  1  0.8196750    \nblock          2.3606  3  0.5010021    \nhybrid:method 24.4985  5  0.0001741 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nPelo menos um híbrido é diferente dos demais, assim como existe diferença significativa na interação híbrido com método\n\n### Teste das premissas\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_normality(mix3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.214).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(mix3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.686).\n```\n:::\n:::\n\n\nAs premissas foram atendidas.\n\n### Comparação das médias entre os grupos\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmedias_milho3 <- emmeans(mix3,\n                        ~hybrid|method) \nmedias_milho4 <- emmeans(mix3,\n                         ~method|hybrid)\n\ncld(medias_milho3, Letters = LETTERS)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nmethod = pin:\n hybrid   emmean   SE   df lower.CL upper.CL .group\n 30S31YH    88.5 4.13 26.1     80.0     97.0  A    \n 30S31H     89.9 4.13 26.1     81.4     98.4  AB   \n 30F53 YH   96.5 4.13 26.1     88.0    105.0  ABC  \n 30F53 HX  105.5 4.13 26.1     97.0    114.0   BC  \n 30K64     108.0 4.13 26.1     99.5    116.5    C  \n BG7049H   109.2 4.13 26.1    100.7    117.6    C  \n\nmethod = silk:\n hybrid   emmean   SE   df lower.CL upper.CL .group\n 30S31YH    90.9 4.13 26.1     82.4     99.4  A    \n 30F53 YH   95.3 4.13 26.1     86.8    103.8  A    \n 30S31H     95.6 4.13 26.1     87.1    104.1  A    \n 30F53 HX   99.7 4.13 26.1     91.2    108.2  AB   \n 30K64     101.6 4.13 26.1     93.1    110.1  AB   \n BG7049H   113.2 4.13 26.1    104.7    121.7   B   \n\nResults are averaged over the levels of: block \nDegrees-of-freedom method: kenward-roger \nResults are given on the sqrt (not the response) scale. \nConfidence level used: 0.95 \nNote: contrasts are still on the sqrt scale \nP value adjustment: tukey method for comparing a family of 6 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n\n```{.r .cell-code}\ncld(medias_milho4, Letters = letters)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nhybrid = 30F53 HX:\n method emmean   SE   df lower.CL upper.CL .group\n silk     99.7 4.13 26.1     91.2    108.2  a    \n pin     105.5 4.13 26.1     97.0    114.0   b   \n\nhybrid = 30F53 YH:\n method emmean   SE   df lower.CL upper.CL .group\n silk     95.3 4.13 26.1     86.8    103.8  a    \n pin      96.5 4.13 26.1     88.0    105.0  a    \n\nhybrid = 30K64:\n method emmean   SE   df lower.CL upper.CL .group\n silk    101.6 4.13 26.1     93.1    110.1  a    \n pin     108.0 4.13 26.1     99.5    116.5   b   \n\nhybrid = 30S31H:\n method emmean   SE   df lower.CL upper.CL .group\n pin      89.9 4.13 26.1     81.4     98.4  a    \n silk     95.6 4.13 26.1     87.1    104.1   b   \n\nhybrid = 30S31YH:\n method emmean   SE   df lower.CL upper.CL .group\n pin      88.5 4.13 26.1     80.0     97.0  a    \n silk     90.9 4.13 26.1     82.4     99.4  a    \n\nhybrid = BG7049H:\n method emmean   SE   df lower.CL upper.CL .group\n pin     109.2 4.13 26.1    100.7    117.6  a    \n silk    113.2 4.13 26.1    104.7    121.7  a    \n\nResults are averaged over the levels of: block \nDegrees-of-freedom method: kenward-roger \nResults are given on the sqrt (not the response) scale. \nConfidence level used: 0.95 \nNote: contrasts are still on the sqrt scale \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n",
    "supporting": [
      "Aula8_quarto_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}