{
  "hash": "b44f23895deca228492dd70dffa76810",
  "result": {
    "markdown": "---\ntitle: \"ANOVA\"\nformat: html\nmessage: false\nwarning: false\n---\n\n\n# Teste de hipótese de três ou mais grupos independentes\n\nA **Análise de Variância (ou ANOVA)** é uma técnica estatística usada para comparar a média de três ou mais grupos e determinar se há diferenças significativas entre eles.\n\nNo caso da ANOVA, as hipóteses formuladas são as seguintes: - **Hipótese nula (Ho)**: as médias dos grupos não diferem entre si - **Hipótese alternativa (Ha)**: pelo menos a média de um dos grupos difere das demais\n\nQuando o conjunto de dados apresenta um único fator, a análise de variância realizada é denominada de *One-Way ANOVA* ou *ANOVA unifatorial*.\n\nQuando o conjunto de dados apresenta dois fatores, a análise de variância realizada é denominada de *Two-Way ANOVA* ou *ANOVA fatorial*.\n\n## Importação dos dados\n\nUsando a função `gsheet2tbl()` do pacote `gsheet`, foi importado um conjunto de dados envolvendo 5 grupos independentes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(gsheet)\nmicelial <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=959387827\")\n```\n:::\n\n\n## Visualização dos dados\n\nPara a visualização dos dados, foi usada a função `ggplot()` juntamente com o `geom_jitter()`. Como o conjunto de dados possui apenas 6 repetições para cada grupo, é preferível usar o jitter que o boxplot.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nmicelial |> \n  ggplot(aes(especie, tcm))+\n  geom_jitter(width = 0.05)\n```\n\n::: {.cell-output-display}\n![](Aula7_quarto_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nPode-se observar que há uma variabilidade visível entre os diferentes grupos, podendo inferir que uma das médias será diferente das demais.\n\n## ANOVA\n\nPara executar uma análise de variância com o conjunto de dados trabalhado, o primeiro passo é ajustar os dados em um modelo linear. Esse ajuste é realiza através da função `lm()`, no qual a fórmula `tcm ~ especie` especifica que tcm (a variável resposta) está sendo modelada em função de especie (a variável preditora).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm1 <- lm(tcm ~ especie, data = micelial)\n```\n:::\n\n\nPara exibir um resumo detalhado do modelo ajustado, pode ser utilizada a função `summary()`. Ela fornece as seguintes informações: - **Coeficientes**: Estimativas dos parâmetros do modelo (intercepto e coeficientes para cada nível de especie). - **Erro padrão**: Medida da precisão das estimativas dos coeficientes. - **Estatística t e valor p**: Usados para testar a hipótese nula de que cada coeficiente é igual a zero (sem efeito). - **R\\^2 e R\\^2 ajustado**: Medidas da qualidade do ajuste do modelo aos dados. - **Estatística F**: Teste global de significância do modelo.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = tcm ~ especie, data = micelial)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.23667 -0.09667  0.01583  0.08833  0.28333 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  1.57167    0.05585  28.140  < 2e-16 ***\nespecieFaus -0.33500    0.07899  -4.241 0.000266 ***\nespecieFcor -0.25000    0.07899  -3.165 0.004047 ** \nespecieFgra -0.66000    0.07899  -8.356 1.05e-08 ***\nespecieFmer -0.14500    0.07899  -1.836 0.078317 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1368 on 25 degrees of freedom\nMultiple R-squared:  0.7585,\tAdjusted R-squared:  0.7199 \nF-statistic: 19.63 on 4 and 25 DF,  p-value: 2.028e-07\n```\n:::\n\n```{.r .cell-code}\n#Se quisermos fazer o summary sem interceptar uma espécie:\nm2 <- lm(tcm ~ especie -1, data = micelial)\nsummary(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = tcm ~ especie - 1, data = micelial)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.23667 -0.09667  0.01583  0.08833  0.28333 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \nespecieFasi  1.57167    0.05585   28.14  < 2e-16 ***\nespecieFaus  1.23667    0.05585   22.14  < 2e-16 ***\nespecieFcor  1.32167    0.05585   23.66  < 2e-16 ***\nespecieFgra  0.91167    0.05585   16.32 7.66e-15 ***\nespecieFmer  1.42667    0.05585   25.54  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1368 on 25 degrees of freedom\nMultiple R-squared:  0.991,\tAdjusted R-squared:  0.9892 \nF-statistic: 552.2 on 5 and 25 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\nPor fim, a análise de variância é executada usando a função `anova()`. Ela fornece as seguintes informações: - **Df**: Graus de liberdade associados ao modelo e aos resíduos. - **Sum Sq**: Soma dos quadrados (Soma dos quadrados do modelo e dos resíduos). - **Mean Sq**: Quadrados médios (Soma dos quadrados dividida pelos graus de liberdade correspondentes). - **F value**: Estatística F (razão dos quadrados médios do modelo e dos resíduos). - **Pr(\\>F)**: Valor p associado à estatística F, usado para testar a hipótese nula de que todos os coeficientes (exceto o intercepto) são iguais a zero.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: tcm\n          Df  Sum Sq Mean Sq F value    Pr(>F)    \nespecie    4 1.46958 0.36739  19.629 2.028e-07 ***\nResiduals 25 0.46792 0.01872                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nComo o p-valor foi inferior ao nível de significância (5%), podemos rejeitar a hipótese nula de que todos os grupos são iguais. Logo, pelo menos uma das médias difere estatisticamente das demais.\n\nContudo, através da ANOVA não é possível saber qual dos grupos difere das demais ou se há mais de um grupo que difere estatisticamente.\n\n## Teste de Tukey\n\nPara saber qual média está se diferindo das demais, deve ser utilizado um teste de comparação de médias, como o Teste de Tukey.\n\nPara realizar esse teste, primeiramente foi usada a função `emmeans()` do pacote `emmeans` para obter as médias da variável resposta em função das espécies (grupos).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(emmeans)\nmedias1 <- emmeans(m1, ~ especie)\nmedias1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n especie emmean     SE df lower.CL upper.CL\n Fasi     1.572 0.0559 25    1.457     1.69\n Faus     1.237 0.0559 25    1.122     1.35\n Fcor     1.322 0.0559 25    1.207     1.44\n Fgra     0.912 0.0559 25    0.797     1.03\n Fmer     1.427 0.0559 25    1.312     1.54\n\nConfidence level used: 0.95 \n```\n:::\n:::\n\n\nUsando a função `cld()` e argumento `Letters = letters` dos pacotes `multcomp`e `multcompView`, é possível visualizar a diferença entre os grupos através do agrupamento das médias estatisticamente iguais representadas pela mesma letra.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(multcomp)\nlibrary(multcompView)\ncld(medias1, Letters = letters)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n especie emmean     SE df lower.CL upper.CL .group\n Fgra     0.912 0.0559 25    0.797     1.03  a    \n Faus     1.237 0.0559 25    1.122     1.35   b   \n Fcor     1.322 0.0559 25    1.207     1.44   b   \n Fmer     1.427 0.0559 25    1.312     1.54   bc  \n Fasi     1.572 0.0559 25    1.457     1.69    c  \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 5 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n\nObservando o resultado do Teste de Tukey, ocorreu a formação de 3 grupos estatisticamente distintos. Pode-se inferir que a espécie *Fgra* difere estatisticamente de todas as outras espécies. A espécie *Fasi* só não difere estatisticamente da espécie *Fmer*. As espécies *Faus* e *Fcor* não diferem entre si e não diferem de *Fmer*, mas diferem do resto das espécies.\n\n## Teste das premissas\n\nNa Análise de Variância, as premissas de normalidade e de homocedasticidade também devem ser atendidas.\n\nO teste de normalidade nesse caso é feito com os *residuals* (é cada diferença entre a média estimada e o valor original).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(m1$residuals)\n```\n\n::: {.cell-output-display}\n![](Aula7_quarto_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\nshapiro.test(m1$residuals)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  m1$residuals\nW = 0.9821, p-value = 0.8782\n```\n:::\n:::\n\n\nObserva-se que não rejeita a hipótese nula, ou seja, os dados são normais.\n\nO teste de variância para três ou mais grupos independentes é feito com o Bartlett-test. Ele é executado usando a função `bartlett.test()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbartlett.test(tcm ~ especie, data = micelial)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  tcm by especie\nBartlett's K-squared = 4.4367, df = 4, p-value = 0.3501\n```\n:::\n\n```{.r .cell-code}\n#Não rejeita a hipótese nula --> são homogêneas\n```\n:::\n\n\nNota-se que a hipótese nula não é rejeitada, indicando que as variâncias são homogêneas.\n\n### Checando as premissas pelo pacote DHARMa\n\nOutra forma de checar se as premissas foram atendidas é através da função `simulateResiduals()` do pacote `DHARMa`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(DHARMa)\nplot(simulateResiduals(m1))\n```\n\n::: {.cell-output-display}\n![](Aula7_quarto_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\nO gráfico da esquerda é um QQ plot dos *residuals*, ele compara a distribuição dos resíduos simulados com a distribuição teórica esperada (geralmente a normal). Os pontos devem seguir a linha diagonal. Desvios significativos da linha indicam que os resíduos não seguem a distribuição esperada, sugerindo que o modelo pode estar mal ajustado. Nesse caso não foi observado nenhum desvio.\n\nO gráfico da direita mostra os resíduos simulados em função dos valores preditos pelo modelo. Para que a premissa da homocedasticidade seja atendida, não deve haver nenhum padrão evidente. Padrões ou tendências podem indicar falta de ajuste, variância não constante ou relações não modeladas entre as variáveis.\n\n### Checando as premissas pelo pacote performance\n\nOutra forma de checar as premissas é através das funções `check_normality()` e `check_heteroscedasticity()` do pacote `performance`. Eles conferem se os dados apresentam distribuição normal e variâncias homogêneas de forma automática.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(performance)\ncheck_normality(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.878).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.880).\n```\n:::\n:::\n\n\n# ANOVA de dados não-paramétricos\n\nAo realizar uma análise de variância, as premissas de normalidade e de homocedasticidade podem não ser atendidas. Nesse caso, é necessário adotar algumas medidas para resolver a análise.\n\nExistem 3 alternativas que podem ser adotadas para que as premissas sejam atendidas: - **Transformação dos dados** - **Teste não-paramétrico** - **GLM**\n\n## Importação dos dados\n\nFoi importando um dataframe nativo do R, denominado de `InsectSprays`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninseticida <- InsectSprays\n```\n:::\n\n\nPara contar quantos inseticidas diferentes foram usados, foi executado a função `count()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninseticida |> \n  count(spray)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  spray  n\n1     A 12\n2     B 12\n3     C 12\n4     D 12\n5     E 12\n6     F 12\n```\n:::\n:::\n\n\n## Visualização dos dados\n\nPara visualizar os dados, foi criado um gráfico de boxplot e de pontos usando as funções `ggplot()`, `geom_boxplot()` e `geom_jitter()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninseticida |> \n  ggplot(aes(spray, count))+\n  geom_jitter(width = 0.05)+\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](Aula7_quarto_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\nPela assimetria dos boxplots e pela suas estruturas, já é possível prever que o conjunto de dados não atende as premissas de normalidade e homocedasticidade.\n\n## ANOVA\n\nPara realizar a análise de variância, os dados foram ajustado ao modelo linear pela função `lm()` e foi executado a `anova()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm2 <- lm(count ~ spray, data = inseticida)\nsummary(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = count ~ spray, data = inseticida)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-8.333 -1.958 -0.500  1.667  9.333 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  14.5000     1.1322  12.807  < 2e-16 ***\nsprayB        0.8333     1.6011   0.520    0.604    \nsprayC      -12.4167     1.6011  -7.755 7.27e-11 ***\nsprayD       -9.5833     1.6011  -5.985 9.82e-08 ***\nsprayE      -11.0000     1.6011  -6.870 2.75e-09 ***\nsprayF        2.1667     1.6011   1.353    0.181    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.922 on 66 degrees of freedom\nMultiple R-squared:  0.7244,\tAdjusted R-squared:  0.7036 \nF-statistic:  34.7 on 5 and 66 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nanova(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: count\n          Df Sum Sq Mean Sq F value    Pr(>F)    \nspray      5 2668.8  533.77  34.702 < 2.2e-16 ***\nResiduals 66 1015.2   15.38                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nCom o p-valor inferior ao nível de significância, a hipótese nula é rejeitada.\n\n## Teste de Tukey\n\nEm seguida foi usado o Teste de Tukey para comparação das médias entre os grupos\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm2_medias <- emmeans(m2, ~ spray)\nplot(m2_medias)\n```\n\n::: {.cell-output-display}\n![](Aula7_quarto_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n\n```{.r .cell-code}\ncld(m2_medias, Letters = letters)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n spray emmean   SE df lower.CL upper.CL .group\n C       2.08 1.13 66   -0.177     4.34  a    \n E       3.50 1.13 66    1.240     5.76  a    \n D       4.92 1.13 66    2.656     7.18  a    \n A      14.50 1.13 66   12.240    16.76   b   \n B      15.33 1.13 66   13.073    17.59   b   \n F      16.67 1.13 66   14.406    18.93   b   \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 6 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n\nPelo resultado do teste nota-se que existem dois grupos estatisticamente diferentes. Sendo que os inseticidas C, E e D não diferem entre si, mas diferem de A, B e F (que por sua vez não diferem entre si).\n\nTanto a Análise de Variância quanto o Teste de Tukey foram executados, no entanto, para que essas análises sejam considerados válidos, é necessário conferir se o conjunto de dados atende às premissas de normalidade e de homocedasticidade.\n\n## Teste de normalidade\n\nO teste de normalidade foi executado por meio do Shapiro-test com os resíduos através da função `shapiro.test()`. Também foi usado `qqnorm()` e `qqline()` para visualizar a normalidade por meio de gráfico.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(m2$residuals)\n```\n\n::: {.cell-output-display}\n![](Aula7_quarto_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n\n```{.r .cell-code}\nshapiro.test(m2$residuals)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  m2$residuals\nW = 0.96006, p-value = 0.02226\n```\n:::\n\n```{.r .cell-code}\nqqnorm(m2$residuals)\nqqline(m2$residuals)\n```\n\n::: {.cell-output-display}\n![](Aula7_quarto_files/figure-html/unnamed-chunk-17-2.png){width=672}\n:::\n:::\n\n\nO Shapiro-test forneceu um p-valor inferior ao nível de significância, rejeitando a hipótese nula de que o dado segue uma distribuição normal, ou seja, os dados não apresentam normalidade.\n\nO gráfico criado também demonstra desvios em relação à reta, o que indica a não normalidade.\n\n## Teste de variância\n\nO teste de variância foi executado com a função `bartlett.test()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbartlett.test(count ~ spray, data = inseticida)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  count by spray\nBartlett's K-squared = 25.96, df = 5, p-value = 9.085e-05\n```\n:::\n\n```{.r .cell-code}\n#Rejeitamos a homogeneicidade entre as variâncias\n```\n:::\n\n\nObserva-se que o p-valor é inferior a 5%, rejeitando a hipótese nula de que as variâncias são homogêneas.\n\nUsando as funções `check_normality()` e `check_heteroscedasticity()`, observa-se os mesmos resultados.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_normality(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWarning: Non-normality of residuals detected (p = 0.022).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWarning: Heteroscedasticity (non-constant error variance) detected (p < .001).\n```\n:::\n:::\n\n\nA função `simulateResiduals()` também indica a falta de homocedasticidade dos dados, embora não indique a falta de normalidade.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(simulateResiduals(m2))\n```\n\n::: {.cell-output-display}\n![](Aula7_quarto_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\nNão atendendo as duas premissas, esse conjunto de dados precisa ser manipulado para que as premissas sejam atendidas e o resultado de sua análise seja válido.\n\n## Alternativa 1 - Transformação de dados\n\nUma medida que pode ser adotada para que os dados atendam as premissas é a transformação dos dados.\n\nOs dados podem ser transformados de diversas formas, mas os principais são por raiz quadrada, por log(x) e por box-cox.\n\n::: callout-note\nPode ser usado log(x + 0.5) ao invés de log(x) quando existe um valor igual a 0 nas variáveis respostas.\n:::\n\n### Transformação por raiz quadrada\n\nUma nova coluna com os valores transformados será criado para o conjunto de dados usando a função `mutate()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninseticida <- inseticida |> \n  mutate(count2 = sqrt(count))\n```\n:::\n\n\nVisualizando os novos dados, é possível notar as alterações.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninseticida |> \n  ggplot(aes(spray, count2))+\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](Aula7_quarto_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\nCom os dados transformados, será realizado uma nova análise de variância para observar se houve alguma mudança.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm3 <- lm(count2 ~ spray,\n         data = inseticida)\nsummary(m3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = count2 ~ spray, data = inseticida)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1.24486 -0.39970 -0.01902  0.42661  1.40089 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   3.7607     0.1814  20.733  < 2e-16 ***\nsprayB        0.1160     0.2565   0.452    0.653    \nsprayC       -2.5158     0.2565  -9.807 1.64e-14 ***\nsprayD       -1.5963     0.2565  -6.223 3.80e-08 ***\nsprayE       -1.9512     0.2565  -7.606 1.34e-10 ***\nsprayF        0.2579     0.2565   1.006    0.318    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.6283 on 66 degrees of freedom\nMultiple R-squared:  0.7724,\tAdjusted R-squared:  0.7552 \nF-statistic:  44.8 on 5 and 66 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nanova(m3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: count2\n          Df Sum Sq Mean Sq F value    Pr(>F)    \nspray      5 88.438 17.6876  44.799 < 2.2e-16 ***\nResiduals 66 26.058  0.3948                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nA análise continua rejeitando a hipótese nula. Em seguida foi comparado as médias entre os grupos.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm3_medias <- emmeans(m3, ~ spray)\nplot(m3_medias)\n```\n\n::: {.cell-output-display}\n![](Aula7_quarto_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n\n```{.r .cell-code}\ncld(m3_medias, Letters = letters) #Os dados transformados discriminou melhor, separou mais\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n spray emmean    SE df lower.CL upper.CL .group\n C       1.24 0.181 66    0.883     1.61  a    \n E       1.81 0.181 66    1.447     2.17  ab   \n D       2.16 0.181 66    1.802     2.53   b   \n A       3.76 0.181 66    3.399     4.12    c  \n B       3.88 0.181 66    3.514     4.24    c  \n F       4.02 0.181 66    3.656     4.38    c  \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 6 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n\nObserva-se que dessa vez foram criados 3 grupos estatisticamente distintos, o que significa que os dados transformados discriminou melhor os grupos.\n\nOutra forma de observar a comparação das médias entre grupos é pela função `pwpm()`, que permite a comparação entre cada grupo, um por um. A função `pwpp()` mostra a comparação entre grupos através de um gráfico. A função `pairs()` compara os grupos par por par.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npwpm(m3_medias)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       A      B      C      D      E      F\nA [3.76] 0.9975 <.0001 <.0001 <.0001 0.9145\nB -0.116 [3.88] <.0001 <.0001 <.0001 0.9936\nC  2.516  2.632 [1.24] 0.0081 0.2513 <.0001\nD  1.596  1.712 -0.919 [2.16] 0.7366 <.0001\nE  1.951  2.067 -0.565  0.355 [1.81] <.0001\nF -0.258 -0.142 -2.774 -1.854 -2.209 [4.02]\n\nRow and column labels: spray\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n```\n:::\n\n```{.r .cell-code}\npwpp(m3_medias)\n```\n\n::: {.cell-output-display}\n![](Aula7_quarto_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n\n```{.r .cell-code}\npairs(m3_medias)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n contrast estimate    SE df t.ratio p.value\n A - B      -0.116 0.257 66  -0.452  0.9975\n A - C       2.516 0.257 66   9.807  <.0001\n A - D       1.596 0.257 66   6.223  <.0001\n A - E       1.951 0.257 66   7.606  <.0001\n A - F      -0.258 0.257 66  -1.006  0.9145\n B - C       2.632 0.257 66  10.259  <.0001\n B - D       1.712 0.257 66   6.675  <.0001\n B - E       2.067 0.257 66   8.058  <.0001\n B - F      -0.142 0.257 66  -0.554  0.9936\n C - D      -0.919 0.257 66  -3.584  0.0081\n C - E      -0.565 0.257 66  -2.201  0.2513\n C - F      -2.774 0.257 66 -10.813  <.0001\n D - E       0.355 0.257 66   1.383  0.7366\n D - F      -1.854 0.257 66  -7.229  <.0001\n E - F      -2.209 0.257 66  -8.612  <.0001\n\nP value adjustment: tukey method for comparing a family of 6 estimates \n```\n:::\n:::\n\n\nAs premissas são conferidas novamente para observar se houve mudança com a transformação dos dados.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(m3$residuals)\n```\n\n::: {.cell-output-display}\n![](Aula7_quarto_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n\n```{.r .cell-code}\nqqnorm(m3$residuals)\nqqline(m3$residuals)\n```\n\n::: {.cell-output-display}\n![](Aula7_quarto_files/figure-html/unnamed-chunk-26-2.png){width=672}\n:::\n\n```{.r .cell-code}\nshapiro.test(m3$residuals)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  m3$residuals\nW = 0.98721, p-value = 0.6814\n```\n:::\n\n```{.r .cell-code}\nbartlett.test(count2 ~ spray,\n              data = inseticida)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  count2 by spray\nBartlett's K-squared = 3.7525, df = 5, p-value = 0.5856\n```\n:::\n\n```{.r .cell-code}\ncheck_normality(m3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.681).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(m3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.854).\n```\n:::\n\n```{.r .cell-code}\nplot(simulateResiduals(m3))\n```\n\n::: {.cell-output-display}\n![](Aula7_quarto_files/figure-html/unnamed-chunk-26-3.png){width=672}\n:::\n:::\n\n\nAs duas premissas foram atendidas, dando validade à análise de variância realizada.\n\n### Transformação por Box-cox\n\nOutra forma de transformar os dados é através do Box-cox. Para essa transformação, é preciso encontrar o valor de lambda ($\\lambda$), extraído a partir da função `boxcox()` do pacote `MASS`. Essa função calcula a verossimilhança perfilhada do parâmetro $\\lambda$. Devemos escolher o valor que maximiza esta função.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(MASS)\nb <- boxcox(lm(inseticida$count+0.1 ~ 1))\n```\n\n::: {.cell-output-display}\n![](Aula7_quarto_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n\n```{.r .cell-code}\nlambda <- b$x[which.max(b$y)]\nlambda\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.4242424\n```\n:::\n:::\n\n\nEncontrado o valor de $\\lambda$, uma nova coluna será adicionada ao conjunto de dados com os novos dados transformados.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninseticida$count3 <- (inseticida$count ^ lambda - 1)/ lambda\ninseticida$count3\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1]  3.903635  3.024469  6.043993  4.864268  4.864268  4.407118  3.903635\n [8]  6.557185  5.484274  6.043993  4.864268  4.640760  4.161975  5.484274\n[15]  6.219699  4.161975  5.285168  4.864268  5.484274  5.484274  5.863153\n[22]  6.219699  3.024469  4.640760 -2.357143  0.000000  3.024469  0.805831\n[29]  1.399509  0.000000  0.805831  0.000000  1.399509 -2.357143  0.000000\n[36]  1.887150  1.399509  2.308577  4.407118  2.683787  1.887150  1.399509\n[43]  2.308577  2.308577  2.308577  2.308577  0.805831  1.887150  1.399509\n[50]  2.308577  1.399509  2.308577  1.399509  2.683787  0.000000  0.000000\n[57]  1.399509  0.805831  2.683787  1.887150  4.161975  3.629951  5.078760\n[64]  6.390651  5.078760  5.285168  4.640760  3.903635  7.033117  7.033117\n[71]  6.719601  4.640760\n```\n:::\n:::\n\n\nDepois de transformados, devem ser realizados os mesmos passos da análise de variância com os novos dados.\n\n## Alternativa 2 - Não paramétrico\n\nOutra alternativa para se trabalhar com dados que não atendem as premissas é realizando um teste não-paramétrico. Dessa forma é analisado os dados originais, sem passar por transformação.\n\nA alternativa não-paramétrica para a ANOVA é o teste de **Kruscal-Wallis**. O teste de Kruscal-Wallis é o teste não paramétrico utilizado na comparação de três ou mais amostras independentes. Ele nos indica se há diferença entre pelo menos dois deles. A aplicação do teste utiliza os valores numéricos transformados em postos (rankings) e agrupados num só conjunto de dados. A comparação dos grupos é realizada por meio da média dos postos (posto médio).\n\nPara executar esse teste, é necessário utiliza a função `kruskal.test()` do pacote `agricolae`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(agricolae)\nkruskal.test(count ~ spray,\n             data = inseticida)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tKruskal-Wallis rank sum test\n\ndata:  count by spray\nKruskal-Wallis chi-squared = 54.691, df = 5, p-value = 1.511e-10\n```\n:::\n:::\n\n\nObserva-se que o p-valor foi inferior ao nível de significância, rejeitando a hipótese nula de que os grupos são iguais.\n\nA comparação da média entre os grupos também pode ser realizado usando a função `kruskal()` e o argumento `group = TRUE`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm4 <- kruskal(inseticida$count, \n              inseticida$spray, \n              group = TRUE)\nm4\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$statistics\n     Chisq Df      p.chisq  t.value      MSD\n  54.69134  5 1.510845e-10 1.996564 8.462804\n\n$parameters\n            test p.ajusted           name.t ntr alpha\n  Kruskal-Wallis      none inseticida$spray   6  0.05\n\n$means\n  inseticida.count     rank      std  r Min Max   Q25  Q50   Q75\nA        14.500000 52.16667 4.719399 12   7  23 11.50 14.0 17.75\nB        15.333333 54.83333 4.271115 12   7  21 12.50 16.5 17.50\nC         2.083333 11.45833 1.975225 12   0   7  1.00  1.5  3.00\nD         4.916667 25.58333 2.503028 12   2  12  3.75  5.0  5.00\nE         3.500000 19.33333 1.732051 12   1   6  2.75  3.0  5.00\nF        16.666667 55.62500 6.213378 12   9  26 12.50 15.0 22.50\n\n$comparison\nNULL\n\n$groups\n  inseticida$count groups\nF         55.62500      a\nB         54.83333      a\nA         52.16667      a\nD         25.58333      b\nE         19.33333     bc\nC         11.45833      c\n\nattr(,\"class\")\n[1] \"group\"\n```\n:::\n:::\n\n\nNota-se que os grupos formados são o mesmo da alternativa 1.\n\n## Alternativa 3 - GLMs\n\nOs **modelos lineares generalizados (GLMs)** são uma ampliação dos modelos lineares ordinários. Os GLM's são usados quando os resíduos (erro) do modelo apresentam distribuição diferente da normal (gaussiana).\n\nNo GLMs, deve-se especificar a distribuição de frequência que deseja utilizar para modelar a variável resposta. Esta distribuição de frequência deve pertencer à família exponencial, que inclui a distribuição de Poisson, Gaussiana, Binomial, Binomial negativa, Gamma, Bernoulli e Beta.\n\nSe Y é uma variável contínua, a sua distribuição de probabilidade deve ser normal. Nesses casos as distribuições recomendadas são a **Gaussiana (Normal)** ou **Gamma**. Se Y é uma variável de proporção que varia continuamente entre 0 e 1 ou 0 e 100, mas não inclui 0 nem 1, a distribuição recomendada é a **Beta**.\n\nSe Y é binário (e.g., vivo ou morto), a distribuição de probabilidade deve ser **Binomial**. Se Y é uma contagem (e.g., abundância ou riqueza de espécies), então a distribuição de probabilidade deve ser **Poisson** ou **Binomial Negativa**.\n\nNo caso do conjunto de dados trabalhado, a variável Y representa uma contagem, o que permite utilizar a família Poisson. Para executar o ajuste do modelo, é utilizado a função `glm()` com o argumento `family = poisson`.\n\nTendo o modelo ajustado, são repetidos os mesmos passos de uma análise de variância normal. A única diferença é que ao invés de usar a função `anova()`, recomenda-se usar a função `Anova()` do pacote `car`, pois ele fornece diretamente o p-valor.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm5 <- glm(count ~ spray,\n          family = poisson,\n          data = inseticida)\nsummary(m5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = count ~ spray, family = poisson, data = inseticida)\n\nCoefficients:\n            Estimate Std. Error z value Pr(>|z|)    \n(Intercept)  2.67415    0.07581  35.274  < 2e-16 ***\nsprayB       0.05588    0.10574   0.528    0.597    \nsprayC      -1.94018    0.21389  -9.071  < 2e-16 ***\nsprayD      -1.08152    0.15065  -7.179 7.03e-13 ***\nsprayE      -1.42139    0.17192  -8.268  < 2e-16 ***\nsprayF       0.13926    0.10367   1.343    0.179    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 409.041  on 71  degrees of freedom\nResidual deviance:  98.329  on 66  degrees of freedom\nAIC: 376.59\n\nNumber of Fisher Scoring iterations: 5\n```\n:::\n\n```{.r .cell-code}\nanova(m5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table\n\nModel: poisson, link: log\n\nResponse: count\n\nTerms added sequentially (first to last)\n\n      Df Deviance Resid. Df Resid. Dev\nNULL                     71     409.04\nspray  5   310.71        66      98.33\n```\n:::\n\n```{.r .cell-code}\nlibrary(car)\nAnova(m5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table (Type II tests)\n\nResponse: count\n      LR Chisq Df Pr(>Chisq)    \nspray   310.71  5  < 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nObserva-se que o p-valor foi inferior ao nível de significância, rejeitando a hipótese nula de que os grupos são iguais.\n\nAs premissas podem ser conferidas através da função `simulateResiduals()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(simulateResiduals(m5))\n```\n\n::: {.cell-output-display}\n![](Aula7_quarto_files/figure-html/unnamed-chunk-32-1.png){width=672}\n:::\n:::\n\n\nEmbora a normalidade não foi atendida, a premissa da homocedasticidade tem maior peso.\n\nO teste de comparação das médias foi executado através do `emmeans()` e `cld()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm5_medias <- emmeans(m5, ~ spray,\n                     type = \"response\")\nm5_medias\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n spray  rate    SE  df asymp.LCL asymp.UCL\n A     14.50 1.099 Inf     12.50     16.82\n B     15.33 1.130 Inf     13.27     17.72\n C      2.08 0.417 Inf      1.41      3.08\n D      4.92 0.640 Inf      3.81      6.35\n E      3.50 0.540 Inf      2.59      4.74\n F     16.67 1.179 Inf     14.51     19.14\n\nConfidence level used: 0.95 \nIntervals are back-transformed from the log scale \n```\n:::\n\n```{.r .cell-code}\ncld(m5_medias)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n spray  rate    SE  df asymp.LCL asymp.UCL .group\n C      2.08 0.417 Inf      1.41      3.08  1    \n E      3.50 0.540 Inf      2.59      4.74  12   \n D      4.92 0.640 Inf      3.81      6.35   2   \n A     14.50 1.099 Inf     12.50     16.82    3  \n B     15.33 1.130 Inf     13.27     17.72    3  \n F     16.67 1.179 Inf     14.51     19.14    3  \n\nConfidence level used: 0.95 \nIntervals are back-transformed from the log scale \nP value adjustment: tukey method for comparing a family of 6 estimates \nTests are performed on the log scale \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n\nAs 3 alternativas deram o mesmo resultado, mas o GLMs é o mais utilizado pelo fato dele não precisar transformar os dados de maneira nenhuma e permitir o uso da ANOVA.\n\n# ANOVA Fatorial\n\nQuando o conjunto de dados apresenta dois fatores, a análise realizada é a ANOVA fatorial.\n\nNa ANOVA fatorial ou Two-Way ANOVA, são formulados 6 hipóteses, sendo 3 hipóteses nulas e 3 hipóteses alternativas:\n\n-   **Hipótese nula 1 (Ho1)**: não há diferença entre os grupos em função do fator A.\n-   **Hipótese alternativa 1 (Ha1)**: há pelo menos uma diferença entre os grupos em função do fator A.\n-   **Hipótese nula 2 (Ho2)**: não há diferença entre os grupos em função do fator B.\n-   **Hipótese alternativa 2 (Ha2)**: há pelo menos uma diferença entre os grupos em função do fator B.\n-   **Hipótese nula 3 (Ho3)**: não há interação entre fator A e fator B. O efeito do fator A nas médias dos grupos é o mesmo para todos os níveis do fator B.\n-   **Hipótese alternativa 3 (Ha3)**: existe uma interação entre fator A e B. O efeito do fator A nas médias dos grupos depende dos níveis do fator B.\n\n## Importação dos dados\n\nOs dados foram importados do Google Sheets pela função `gsheet2tbl()` do pacote `gsheet`. O conjunto de dados avalia a severidade de uma doença em função de dois fatores: o tipo de tratamento aplicado e as doses do tratamento.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nli <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=2023059672\")\nli\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 20 × 8\n   treat         dose   rep  n_sp dis_sp n_seeds inf_seeds severity\n   <chr>        <dbl> <dbl> <dbl>  <dbl>   <dbl>     <dbl>    <dbl>\n 1 Ionic liquid   0.5     1   103     13      25        10   0.126 \n 2 Ionic liquid   0.5     2   125     31      25        12   0.248 \n 3 Ionic liquid   0.5     3   210     80      25        12   0.381 \n 4 Ionic liquid   0.5     4    97     28      25        10   0.289 \n 5 Ionic liquid   0.5     5   180     75      25        11   0.417 \n 6 Ionic liquid   2       2   116      9      25         6   0.0776\n 7 Ionic liquid   2       3   166      7      25         3   0.0422\n 8 Ionic liquid   2       4   157     12      25         1   0.0764\n 9 Ionic liquid   2       5   129      7      25         7   0.0543\n10 Ionic liquid   2       1    84      0      25         1   0     \n11 Tebuconazole   0.5     1   121      0      25         2   0     \n12 Tebuconazole   0.5     2   123      6      25         5   0.0488\n13 Tebuconazole   0.5     3   107      3      25         1   0.0280\n14 Tebuconazole   0.5     4    90      0      25         2   0     \n15 Tebuconazole   0.5     5   142      4      25         1   0.0282\n16 Tebuconazole   2       1   166      3      25         5   0.0181\n17 Tebuconazole   2       2   120      0      25         2   0     \n18 Tebuconazole   2       3   100      4      25         2   0.04  \n19 Tebuconazole   2       4    96      3      25         0   0.0312\n20 Tebuconazole   2       5   170      2      25         4   0.0118\n```\n:::\n:::\n\n\n## Visualização dos dados\n\nComo o número de repetições é baixo, o conjunto de dados será visualizado com um gráfico de pontos usando a função `ggplot()` juntamente a `geom_jitter()`. A função `facet_wrap()` foi usada para dividir os dados em função do tratamento aplicado.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggthemes)\nli |> \n  ggplot(aes(factor(dose), severity, color = factor(dose)))+\n  geom_jitter(width = 0.1)+\n  facet_wrap(~treat)+\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](Aula7_quarto_files/figure-html/unnamed-chunk-35-1.png){width=672}\n:::\n:::\n\n\n## Modelo fatorial (2-way ANOVA)\n\nA função utilizada para o ajuste do modelo linear é a mesma: `lm()`. No entanto, como se trata de dois fatores envolvidos (treat e dose), a fórmula usada é `severity ~ treat*factor(dose)`. O grupo *dose* foi especificado como um fator para que ele não fosse considerado como uma variável numérica.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmf <- lm(severity ~ treat*factor(dose),\n         data = li)\nmf\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = severity ~ treat * factor(dose), data = li)\n\nCoefficients:\n                    (Intercept)                treatTebuconazole  \n                         0.2921                          -0.2711  \n                  factor(dose)2  treatTebuconazole:factor(dose)2  \n                        -0.2420                           0.2412  \n```\n:::\n:::\n\n\nCom o modelo linear ajustado, foi feito a ANOVA usando a função `anova()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(mf)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: severity\n                   Df   Sum Sq  Mean Sq F value    Pr(>F)    \ntreat               1 0.113232 0.113232  30.358 4.754e-05 ***\nfactor(dose)        1 0.073683 0.073683  19.755 0.0004077 ***\ntreat:factor(dose)  1 0.072739 0.072739  19.502 0.0004326 ***\nResiduals          16 0.059678 0.003730                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nEm relação ao fator tratamento, observa-se que o p-valor foi inferior ao nível de significância (5%), rejeitando a hipótese nula de que os grupos são iguais em função do tratamento aplicado.\n\nTambém nota-se que em relação ao fator dose, o p-valor foi inferior ao nível de significância (5%), rejeitando a hipótese nula de que os grupos são iguais em função das doses aplicadas.\n\nPor último também foi visto que a interação entre os fatores \"tratamento\" e \"dose\" foi significativo, indicando que a interação entre esses dois fatores interferem nas diferenças estatísticas entre os grupos.\n\n## Teste das premissas\n\nAs premissas foram checadas através das funções `simulateResiduals()`, `check_normality()` e `check_heteroscedasticity()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(simulateResiduals(mf))\n```\n\n::: {.cell-output-display}\n![](Aula7_quarto_files/figure-html/unnamed-chunk-38-1.png){width=672}\n:::\n\n```{.r .cell-code}\ncheck_normality(mf)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWarning: Non-normality of residuals detected (p = 0.011).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(mf)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWarning: Heteroscedasticity (non-constant error variance) detected (p < .001).\n```\n:::\n:::\n\n\nAs funções do pacote `performance` apresentaram problemas em relação à normalidade e homocedasticidade, no entanto, a função `simulateResiduals()` não demonstrou problema nas premissas.\n\n## Teste de comparação das médias\n\nEm seguida, foi feito a comparação entre as médias dos grupos usando as funções `emmeans()` e `cld()`.\n\nPor se tratar de dois fatores, foi comparado as médias entre os grupos em função de cada fator, usando as fórmulas `~ treat|dose` para comparar as médias dos tratamentos em função das doses e `~ dose|treat` para comparar as médias das doses em função dos tratamentos.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmf_medias <- emmeans(mf, ~ treat|dose)\nmf_medias\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ndose = 0.5:\n treat        emmean     SE df lower.CL upper.CL\n Ionic liquid 0.2921 0.0273 16  0.23420   0.3500\n Tebuconazole 0.0210 0.0273 16 -0.03690   0.0789\n\ndose = 2.0:\n treat        emmean     SE df lower.CL upper.CL\n Ionic liquid 0.0501 0.0273 16 -0.00781   0.1080\n Tebuconazole 0.0202 0.0273 16 -0.03768   0.0781\n\nConfidence level used: 0.95 \n```\n:::\n\n```{.r .cell-code}\ncld(mf_medias, Letters = letters)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ndose = 0.5:\n treat        emmean     SE df lower.CL upper.CL .group\n Tebuconazole 0.0210 0.0273 16 -0.03690   0.0789  a    \n Ionic liquid 0.2921 0.0273 16  0.23420   0.3500   b   \n\ndose = 2.0:\n treat        emmean     SE df lower.CL upper.CL .group\n Tebuconazole 0.0202 0.0273 16 -0.03768   0.0781  a    \n Ionic liquid 0.0501 0.0273 16 -0.00781   0.1080  a    \n\nConfidence level used: 0.95 \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n\n```{.r .cell-code}\nplot(cld(mf_medias))\n```\n\n::: {.cell-output-display}\n![](Aula7_quarto_files/figure-html/unnamed-chunk-39-1.png){width=672}\n:::\n\n```{.r .cell-code}\nmf_medias2 <- emmeans(mf, ~dose|treat)\ncld(mf_medias2, Letters = letters)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ntreat = Ionic liquid:\n dose emmean     SE df lower.CL upper.CL .group\n  2.0 0.0501 0.0273 16 -0.00781   0.1080  a    \n  0.5 0.2921 0.0273 16  0.23420   0.3500   b   \n\ntreat = Tebuconazole:\n dose emmean     SE df lower.CL upper.CL .group\n  2.0 0.0202 0.0273 16 -0.03768   0.0781  a    \n  0.5 0.0210 0.0273 16 -0.03690   0.0789  a    \n\nConfidence level used: 0.95 \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n\n```{.r .cell-code}\nplot(cld(mf_medias2))\n```\n\n::: {.cell-output-display}\n![](Aula7_quarto_files/figure-html/unnamed-chunk-39-2.png){width=672}\n:::\n:::\n\n\n::: callout-note\nNa montagem de uma tabela de comparação das médias entre os grupos, as letras maiúsculas são usadas para comparar as mesmas colunas, enquanto que as letras minúsculas são usadas para comparar as mesmas linhas\n:::\n",
    "supporting": [
      "Aula7_quarto_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}