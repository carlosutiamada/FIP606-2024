{"title":"ANOVA em blocos casualizados e parcela subdividida","markdown":{"yaml":{"title":"ANOVA em blocos casualizados e parcela subdividida","format":"html","message":false,"warning":false},"headingText":"ANOVA em blocos casualizados","containsRefs":false,"markdown":"\n\n\nO delineamento em blocos casualizado (DBC) envolve os três princípios da experimentação: repetição, casualização e controle local. Neste caso, as condições locais não são homogêneas e podem ter efeito significativo sobre os tratamentos, sendo necessário o uso de blocos para controlar uma variação conhecida do ambiente.\n\nAssim, a ANOVA contará com três fontes de variação: duas fontes de variação conhecidas (tratamento e bloco), e uma fonte de variação desconhecida (resíduo).\n\nVale destacar que no DBC não há interesse pela interação do bloco com o tratamento, sendo o bloco apenas para controlar uma possível variação sobre os tratamentos induzida por uma possível variação do ambiente.\n\n## Importação dos dados\n\nO conjunto de dados foi importado do Google Sheet através da função `gsheet2tbl()` do pacote `gsheet`.\n\nOs dados importados contam com três variáveis respostas: DFC, Ferrugem e Produtividade. Foram experimentados 8 tratamentos, com 4 blocos.\n\n```{r}\nlibrary(tidyverse)\nlibrary(gsheet)\n\nsoja <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=866852711\")\n```\n\nPara cada variável resposta será feito uma ANOVA. Mas primeiro é necessário considerar o número dos tratamentos e os números dos blocos como fatores. Isso pode ser feito usando a função `mutate()`.\n\n```{r}\nsoja <- soja |> \n  mutate(TRAT = as.factor(TRAT),\n         BLOCO = as.factor(BLOCO))\n```\n\n## Visualização dos dados\n\nPara cada variável resposta foi criado um gráfico de pontos com a média e o intervalo de confiança de cada tratamento. O gráfico foi feito usando as funções `ggplot()`, `geom_jitter()` e `stat_summary()`, com o argumento `fun.data = \"mean_cl_boot\"` (esse argumento cria a bola representando a média e as linhas representando o intervalo de confiança)\n\nDepois, os 3 gráficos foram colocados juntos através do pacote `patchwork`.\n\n```{r}\ndfc <- soja |> \n  ggplot(aes(TRAT, DFC))+\n  geom_jitter(width = 0.1, color = \"gray70\")+\n  stat_summary(fun.data = \"mean_cl_boot\", color = \"black\")\ndfc\n\nfer <- soja |> \n  ggplot(aes(TRAT, FER))+\n  geom_jitter(width = 0.1, color = \"gray70\")+\n  stat_summary(fun.data = \"mean_cl_boot\", color = \"blue\")\nfer\n\nprod <- soja |> \n  ggplot(aes(TRAT, PROD))+\n  geom_jitter(width = 0.1, color = \"gray70\")+\n  stat_summary(fun.data = \"mean_cl_boot\", color = \"red\")\nprod\n\nlibrary(patchwork)\ndfc / fer / prod\n```\n\n## ANOVA DFC\n\nComo não há interesse da interação entre o bloco e o tratamento, é preciso ajustar o modelo linear de modo que o bloco seja considerado como efeito fixo. Isso pode ser feito usando a função `lm()` juntamente com a fórmula `DFC ~ TRAT+BLOCO` (o \"+\" garante que o BLOCO seja visto como efeito fixo)\n\n```{r}\naov_dfc <- lm(DFC ~ TRAT+BLOCO,\n              data = soja)\n```\n\nCom o modelo ajustado, é executado a ANOVA usando a função `anova()`.\n\n```{r}\nanova(aov_dfc)\n```\n\nPelo resultado da ANOVA, pode-se observar que o efeito dos tratamentos na váriavel DFC é significativo, enquanto que o efeito dos blocos não é significativo.\n\n### Teste das premissas\n\nAs premissas foram checadas através das funções `check_heteroscedasticity()` e `check_normality()`\n\n```{r}\nlibrary(performance)\ncheck_heteroscedasticity(aov_dfc)\ncheck_normality(aov_dfc)\n```\n\nAmbas as premissas foram atendidas\n\n### Comparação das médias entre os grupos\n\nA comparação das médias entre os grupos foi realizada com as funções `emmeans()` e `cld`.\n\n```{r}\nlibrary(emmeans)\nmedias_dfc <- emmeans(aov_dfc, ~ TRAT)\n\nlibrary(multcomp)\nlibrary(multcompView)\ncld(medias_dfc, Letters = letters)\n```\n\nObserva-se a formação de 4 grupos estatisticamente distintos.\n\nA eficácia no controle do DFC pode ser calculado através da seguinte fórmula: Eficácia no controle (%) = (1- (emmean do tratamento/emmean da testemunha))\\*100\n\n## ANOVA FER\n\n```{r}\naov_fer <- lm(FER ~ TRAT+BLOCO,\n              data = soja)\nanova(aov_fer)\n```\n\n### Teste das premissas\n\n```{r}\ncheck_heteroscedasticity(aov_fer)\ncheck_normality(aov_fer)\n```\n\nAmbas as premissas não foram atendidas.\n\n### Transformação dos dados por Boxcox\n\n```{r}\nb <- boxcox(lm(soja$FER ~ 1))\nlambda <- b$x[which.max(b$y)]\nlambda\nsoja$FER3 <- (soja$FER ^ lambda - 1)/ lambda\n```\n\n### Nova ANOVA com os dados transformados\n\n```{r}\naov_fer3 <- lm(FER3 ~ TRAT+BLOCO,\n              data = soja)\nanova(aov_fer3)\n```\n\nCom os dados transformados, nota-se que o efeito dos blocos também é significante para variável resposta da ferrugem.\n\n### Nova checagem das premissas\n\n```{r}\ncheck_normality(aov_fer3)\ncheck_heteroscedasticity(aov_fer3)\n```\n\n### Comparação das médias entre os grupos\n\n```{r}\nmedias_fer2 <- emmeans(aov_fer3, ~ TRAT)\nmedias_fer2\npwpm(medias_fer2)\n\ncld(medias_fer2, Letters = letters)\n```\n\nObserva-se a formação de 3 grupos estatisticamente distintos.\n\n## ANOVA PROD\n\n```{r}\naov_prod <- lm(PROD ~ TRAT+BLOCO,\n              data = soja)\nanova(aov_prod)\n```\n\n### Teste das premissas\n\n```{r}\ncheck_heteroscedasticity(aov_prod)\ncheck_normality(aov_prod)\n```\n\nAmbas as premissas foram atendidas\n\n### Comparação das médias entre os grupos\n\n```{r}\nmedias_prod <- emmeans(aov_prod, ~ TRAT)\nmedias_prod\npwpm(medias_prod)\ncld(medias_prod, Letters = letters)\n```\n\nObserva-se a formação de 2 grupos estatisticamente distintos.\n\nA diferença de produtividade pode ser calculada pela seguinte fórmula: Diferença de produtividade = emmean do tratamento - emmean da testemunha\n\n### Outra forma de visualizar os valores da produtividade\n\n```{r}\nmedias_prod_grupo <- cld(medias_prod, Letters = letters)\ndf_prod <- data.frame(medias_prod_grupo)\ndf_prod |> \n  ggplot(aes(TRAT, emmean))+\n  geom_point()+\n  ylim(3000,6500)+\n  geom_errorbar(aes(min = lower.CL,\n                    max = upper.CL),\n                width = 0.1)+\n  annotate(geom = \"text\", x = 1.2, y = 4200, label = \"A\")+\n  annotate(geom = \"text\", x = 2.3, y = 5000, label = \"AB\")\n```\n\n### Exportando a tabela de comparação das médias entre os grupos\n\nUsando a função `write_xlsx()` do pacote `writexl`, é possível exportar a tabela de comparação das médias entre os grupos para um arquivo Excel.\n\n```{r}\nknitr::kable(df_prod |> dplyr::select(TRAT, emmean, .group))\nlibrary(writexl)\nwrite_xlsx(df_prod, \"df.xlsx\")\n```\n\n# ANOVA da área abaixo da curva de progresso da doença\n\nA área abaixo da curva de progresso da doença (AACPD) é um parâmetro quantitativo muito utilizado em diversos patossistemas na análise do progresso das doenças em plantas, o seu valor é obtido após uma série de avaliações de severidade ao longo do tempo.\n\n## Importação dos dados\n\nO conjunto de dados foi importado a partir do Google Sheet através da função `gsheet2tbl()` do pacote `gsheet`. Como os dados não estavam no formato de data frame, foi usado a função `as.data.frame()` para realizar a conversão.\n\nO conjunto de dados apresenta a severidade de uma doença em função do dia e do modo de irrigação.\n\n```{r}\ncurve <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=1807247585\")\ncurve = as.data.frame(curve)\n```\n\n## Visualização dos dados\n\nPor ser um conjunto de dados que possui uma variável numérica em função de um fator temporal, foi construído um gráfico de linhas para exibir o progresso da severidade da doença em função dos dias. Para isso, foi usado as funções `ggplot()` juntamente a `geom_point()` e `geom_line()`.\n\nTambém foram feitos gráficos separando os dados em função dos diferentes modos de irrigação utilizados no experimento.\n\n```{r}\ncurve |> \n  group_by(day) |> \n  summarise(severity_mean = mean(severity),\n            severity_sd = sd(severity)) |> \n  ggplot(aes(day, severity_mean))+\n  geom_point(width = 0.05)+\n  geom_line()\n\ncurve |> \n  group_by(day, Irrigation) |> \n  summarise(severity_mean = mean(severity),\n            severity_sd = sd(severity)) |> \n  ggplot(aes(day, severity_mean, color = Irrigation))+\n  geom_point(width = 0.05)+\n  geom_line()\n\ncurve |> \n  group_by(day, Irrigation) |> \n  summarise(severity_mean = mean(severity)) |> \n  ggplot(aes(day, severity_mean))+\n  geom_point(width = 0.05)+\n  geom_line()+\n  facet_grid(~Irrigation)\n```\n\n## AUDPC\n\nPara calcular a AUDPC (o mesmo que AACPD), foi usado o pacote `epifitter` junto com a função `summarise(AUDPC())`.\n\n```{r}\nlibrary(epifitter)\naudpc <- curve |> \n  group_by(Irrigation, rep) |> \n  summarise(aacpd = AUDPC(day, severity))\n```\n\n## ANOVA da AUDPC\n\nTendo os dados da AUDPC, o conjunto de dados foi ajustado para o modelo linear usando a função `lm()` e a fórmula `aacpd ~ Irrigation + factor(rep)`, na qual as repetições foram considerados como efeito fixo.\n\nPosteriormente, foi realizado uma análise de variância.\n\n```{r}\naov_audpc <- lm(aacpd ~ Irrigation + factor(rep),\n                data = audpc) \nanova(aov_audpc)\n```\n\nPelos resultados, percebe-se que tanto o modo de irrigação quanto as repetições tiveram efeitos pouco significativos em relação ao AUDPC.\n\nUsando os dados originais importados, foi também realizado uma ANOVA da severidade da doença em função do modo de irrigação interagindo com o fator dia, com as repetições novamente como efeito fixo.\n\n```{r}\naov_curve <- lm(severity ~ Irrigation*day + rep,\n         data = curve)\nanova(aov_curve)\n```\n\nObserva-se que o fator dia teve um efeito significativo sobre a severidade da doença, enquanto que os outros componentes não tiveram efeitos sobre a variável.\n\n### Coeficiente de variação\n\nO coeficiente de variação (CV) é um indicador da variabilidade de um conjunto de dados. Ele pode ser encontrado usando a função `cv.model()` do pacote `agricolae`.\n\n```{r}\nlibrary(agricolae)\ncv.model(aov_audpc)\n```\n\n# Parcela subdividida\n\nNo delineamento em parcelas subdivididas existem dois tipos de tratamento: o principal e o secundário. As parcelas são subdivididas no espaço, ou no tempo. Depois que os tratamentos principais (parcelas) são sorteados, sorteia-se o tratamento secundário (subparcelas) dentro das parcelas.\n\nOs tratamentos primários são distribuídos às parcelas de acordo com um delineamento especificado (efeito fixo).\n\nOs tratamentos secundários são distribuídos às subparcelas de forma aleatória (efeito aleatório).\n\nDesse modo, em delineamento de parcela subdivida é trabalhado um modelo misto: fator fixo + fator aleatório.\n\n## Importação dos dados\n\nO conjunto de dados foi importado a partir do Google Sheet através da função `gsheet2tbl()` do pacote `gsheet`.\n\nEsses dados representam podridão de Fusarium em milho em parcelas subdivididas. Dentro de cada bloco foi casualizado os híbridos (tratamento primário). O método de aplicação foi casualizado dentro dos híbridos (tratamento secundário).\n\n```{r}\nmilho <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=1345524759\")\n```\n\n## Visualização dos dados\n\nForam criados dois gráficos de pontos com intervalos de confiança, sendo um gráfico sobre o índice e outro sobre a produtividade. Os gráficos foram criados usando as funções `ggplot()`, `geom_jitter()` e `stat_summary` (para criar os pontos médios e intervalos de confiança)\n\n```{r}\nmilho |> \n  ggplot(aes(method, index))+\n  geom_jitter(width = 0.1, color = \"black\", alpha = 0.2)+\n  facet_grid(~hybrid)+\n  stat_summary(fun.data = \"mean_cl_boot\", color = \"blue\")\n\nmilho |> \n  ggplot(aes(method, yield))+\n  geom_jitter(width = 0.1, color = \"black\", alpha = 0.2)+\n  facet_grid(~hybrid)+\n  stat_summary(fun.data = \"mean_cl_boot\", color = \"red\")\n```\n\n## Modelo para parcela subdividida - index\n\nEm relação à variável resposta de índice, o modelo do conjunto de dados foi ajustado para o modelo misto usando a função `lmer()` do pacote `lme4`. Para atribuir os efeitos fixos e aleatórios, foi usado a seguinte fórmula: `index ~ hybrid*method + block + (1|block/hybrid)`, no qual os blocos estão como efeitos fixos e os híbridos como efeitos aleatórios.\n\n```{r}\nlibrary(lme4)\n\nmilho <- milho |> \n  mutate(block = as.factor(block))\n\nmix <- lmer(index ~ hybrid*method + block + (1|block/hybrid), \n             data = milho)\n```\n\nA análise de variância foi executada com a função `Anova()` do pacote `car`.\n\n```{r}\nlibrary(car)\nAnova(mix)\n```\n\nPode-se concluir que pelo menos um híbrido é diferente dos demais, assim como existe diferença significativa entre os métodos. A interação entre híbridos e métodos também resultou em uma diferença estatística.\n\n### Teste das premissas\n\n```{r}\ncheck_normality(mix)\ncheck_heteroscedasticity(mix)\n\nlibrary(DHARMa)\nplot(simulateResiduals(mix))\n```\n\nA premissa da homocedasticidade não foi atendida, sendo necessário realizar transformação dos dados.\n\n### Transformação com raiz quadrada\n\n```{r}\nmix2 <- lmer(sqrt(index) ~ hybrid*method + block + (1|block/hybrid), \n             data = milho)\nAnova(mix2)\ncheck_normality(mix2)\ncheck_heteroscedasticity(mix2)\nplot(simulateResiduals(mix2))\n\nqqnorm(residuals(mix2))\nqqline(residuals(mix2))\nhist(residuals(mix2))\n```\n\nDessa vez as premissas foram atendidas.\n\n### Comparação das médias entre os grupos\n\nO teste de comparação das médias entre os grupos foi realizado com as funções `emmeans()` e `cld()`.\n\nComo a interação entre híbridos e métodos deu um valor significativo, o teste de comparação das médias foi tanta sobre os híbridos em função dos métodos, quando dos métodos em função dos híbridos.\n\n```{r}\nmedias_milho <- emmeans(mix2,\n                        ~hybrid|method,\n                        type = \"response\") #Qaundo transforma dados, precisa colocar type = response\nmedias_milho2 <- emmeans(mix2,\n                         ~method|hybrid,\n                         type = \"response\")\n\ncld(medias_milho, Letters = LETTERS)\ncld(medias_milho2, Letters = letters)\n```\n\n## Modelo para parcela subdividida - yield\n\nOs mesmos processos foram repetidos para a variável resposta produtividade.\n\n```{r}\nmix3 <- lmer(sqrt(yield) ~ hybrid*method + block + (1|block/hybrid), \n             data = milho)\nAnova(mix3)\n```\n\nPelo menos um híbrido é diferente dos demais, assim como existe diferença significativa na interação híbrido com método\n\n### Teste das premissas\n\n```{r}\ncheck_normality(mix3)\ncheck_heteroscedasticity(mix3)\n```\n\nAs premissas foram atendidas.\n\n### Comparação das médias entre os grupos\n\n```{r}\nmedias_milho3 <- emmeans(mix3,\n                        ~hybrid|method) \nmedias_milho4 <- emmeans(mix3,\n                         ~method|hybrid)\n\ncld(medias_milho3, Letters = LETTERS)\ncld(medias_milho4, Letters = letters)\n```\n","srcMarkdownNoYaml":"\n\n# ANOVA em blocos casualizados\n\nO delineamento em blocos casualizado (DBC) envolve os três princípios da experimentação: repetição, casualização e controle local. Neste caso, as condições locais não são homogêneas e podem ter efeito significativo sobre os tratamentos, sendo necessário o uso de blocos para controlar uma variação conhecida do ambiente.\n\nAssim, a ANOVA contará com três fontes de variação: duas fontes de variação conhecidas (tratamento e bloco), e uma fonte de variação desconhecida (resíduo).\n\nVale destacar que no DBC não há interesse pela interação do bloco com o tratamento, sendo o bloco apenas para controlar uma possível variação sobre os tratamentos induzida por uma possível variação do ambiente.\n\n## Importação dos dados\n\nO conjunto de dados foi importado do Google Sheet através da função `gsheet2tbl()` do pacote `gsheet`.\n\nOs dados importados contam com três variáveis respostas: DFC, Ferrugem e Produtividade. Foram experimentados 8 tratamentos, com 4 blocos.\n\n```{r}\nlibrary(tidyverse)\nlibrary(gsheet)\n\nsoja <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=866852711\")\n```\n\nPara cada variável resposta será feito uma ANOVA. Mas primeiro é necessário considerar o número dos tratamentos e os números dos blocos como fatores. Isso pode ser feito usando a função `mutate()`.\n\n```{r}\nsoja <- soja |> \n  mutate(TRAT = as.factor(TRAT),\n         BLOCO = as.factor(BLOCO))\n```\n\n## Visualização dos dados\n\nPara cada variável resposta foi criado um gráfico de pontos com a média e o intervalo de confiança de cada tratamento. O gráfico foi feito usando as funções `ggplot()`, `geom_jitter()` e `stat_summary()`, com o argumento `fun.data = \"mean_cl_boot\"` (esse argumento cria a bola representando a média e as linhas representando o intervalo de confiança)\n\nDepois, os 3 gráficos foram colocados juntos através do pacote `patchwork`.\n\n```{r}\ndfc <- soja |> \n  ggplot(aes(TRAT, DFC))+\n  geom_jitter(width = 0.1, color = \"gray70\")+\n  stat_summary(fun.data = \"mean_cl_boot\", color = \"black\")\ndfc\n\nfer <- soja |> \n  ggplot(aes(TRAT, FER))+\n  geom_jitter(width = 0.1, color = \"gray70\")+\n  stat_summary(fun.data = \"mean_cl_boot\", color = \"blue\")\nfer\n\nprod <- soja |> \n  ggplot(aes(TRAT, PROD))+\n  geom_jitter(width = 0.1, color = \"gray70\")+\n  stat_summary(fun.data = \"mean_cl_boot\", color = \"red\")\nprod\n\nlibrary(patchwork)\ndfc / fer / prod\n```\n\n## ANOVA DFC\n\nComo não há interesse da interação entre o bloco e o tratamento, é preciso ajustar o modelo linear de modo que o bloco seja considerado como efeito fixo. Isso pode ser feito usando a função `lm()` juntamente com a fórmula `DFC ~ TRAT+BLOCO` (o \"+\" garante que o BLOCO seja visto como efeito fixo)\n\n```{r}\naov_dfc <- lm(DFC ~ TRAT+BLOCO,\n              data = soja)\n```\n\nCom o modelo ajustado, é executado a ANOVA usando a função `anova()`.\n\n```{r}\nanova(aov_dfc)\n```\n\nPelo resultado da ANOVA, pode-se observar que o efeito dos tratamentos na váriavel DFC é significativo, enquanto que o efeito dos blocos não é significativo.\n\n### Teste das premissas\n\nAs premissas foram checadas através das funções `check_heteroscedasticity()` e `check_normality()`\n\n```{r}\nlibrary(performance)\ncheck_heteroscedasticity(aov_dfc)\ncheck_normality(aov_dfc)\n```\n\nAmbas as premissas foram atendidas\n\n### Comparação das médias entre os grupos\n\nA comparação das médias entre os grupos foi realizada com as funções `emmeans()` e `cld`.\n\n```{r}\nlibrary(emmeans)\nmedias_dfc <- emmeans(aov_dfc, ~ TRAT)\n\nlibrary(multcomp)\nlibrary(multcompView)\ncld(medias_dfc, Letters = letters)\n```\n\nObserva-se a formação de 4 grupos estatisticamente distintos.\n\nA eficácia no controle do DFC pode ser calculado através da seguinte fórmula: Eficácia no controle (%) = (1- (emmean do tratamento/emmean da testemunha))\\*100\n\n## ANOVA FER\n\n```{r}\naov_fer <- lm(FER ~ TRAT+BLOCO,\n              data = soja)\nanova(aov_fer)\n```\n\n### Teste das premissas\n\n```{r}\ncheck_heteroscedasticity(aov_fer)\ncheck_normality(aov_fer)\n```\n\nAmbas as premissas não foram atendidas.\n\n### Transformação dos dados por Boxcox\n\n```{r}\nb <- boxcox(lm(soja$FER ~ 1))\nlambda <- b$x[which.max(b$y)]\nlambda\nsoja$FER3 <- (soja$FER ^ lambda - 1)/ lambda\n```\n\n### Nova ANOVA com os dados transformados\n\n```{r}\naov_fer3 <- lm(FER3 ~ TRAT+BLOCO,\n              data = soja)\nanova(aov_fer3)\n```\n\nCom os dados transformados, nota-se que o efeito dos blocos também é significante para variável resposta da ferrugem.\n\n### Nova checagem das premissas\n\n```{r}\ncheck_normality(aov_fer3)\ncheck_heteroscedasticity(aov_fer3)\n```\n\n### Comparação das médias entre os grupos\n\n```{r}\nmedias_fer2 <- emmeans(aov_fer3, ~ TRAT)\nmedias_fer2\npwpm(medias_fer2)\n\ncld(medias_fer2, Letters = letters)\n```\n\nObserva-se a formação de 3 grupos estatisticamente distintos.\n\n## ANOVA PROD\n\n```{r}\naov_prod <- lm(PROD ~ TRAT+BLOCO,\n              data = soja)\nanova(aov_prod)\n```\n\n### Teste das premissas\n\n```{r}\ncheck_heteroscedasticity(aov_prod)\ncheck_normality(aov_prod)\n```\n\nAmbas as premissas foram atendidas\n\n### Comparação das médias entre os grupos\n\n```{r}\nmedias_prod <- emmeans(aov_prod, ~ TRAT)\nmedias_prod\npwpm(medias_prod)\ncld(medias_prod, Letters = letters)\n```\n\nObserva-se a formação de 2 grupos estatisticamente distintos.\n\nA diferença de produtividade pode ser calculada pela seguinte fórmula: Diferença de produtividade = emmean do tratamento - emmean da testemunha\n\n### Outra forma de visualizar os valores da produtividade\n\n```{r}\nmedias_prod_grupo <- cld(medias_prod, Letters = letters)\ndf_prod <- data.frame(medias_prod_grupo)\ndf_prod |> \n  ggplot(aes(TRAT, emmean))+\n  geom_point()+\n  ylim(3000,6500)+\n  geom_errorbar(aes(min = lower.CL,\n                    max = upper.CL),\n                width = 0.1)+\n  annotate(geom = \"text\", x = 1.2, y = 4200, label = \"A\")+\n  annotate(geom = \"text\", x = 2.3, y = 5000, label = \"AB\")\n```\n\n### Exportando a tabela de comparação das médias entre os grupos\n\nUsando a função `write_xlsx()` do pacote `writexl`, é possível exportar a tabela de comparação das médias entre os grupos para um arquivo Excel.\n\n```{r}\nknitr::kable(df_prod |> dplyr::select(TRAT, emmean, .group))\nlibrary(writexl)\nwrite_xlsx(df_prod, \"df.xlsx\")\n```\n\n# ANOVA da área abaixo da curva de progresso da doença\n\nA área abaixo da curva de progresso da doença (AACPD) é um parâmetro quantitativo muito utilizado em diversos patossistemas na análise do progresso das doenças em plantas, o seu valor é obtido após uma série de avaliações de severidade ao longo do tempo.\n\n## Importação dos dados\n\nO conjunto de dados foi importado a partir do Google Sheet através da função `gsheet2tbl()` do pacote `gsheet`. Como os dados não estavam no formato de data frame, foi usado a função `as.data.frame()` para realizar a conversão.\n\nO conjunto de dados apresenta a severidade de uma doença em função do dia e do modo de irrigação.\n\n```{r}\ncurve <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=1807247585\")\ncurve = as.data.frame(curve)\n```\n\n## Visualização dos dados\n\nPor ser um conjunto de dados que possui uma variável numérica em função de um fator temporal, foi construído um gráfico de linhas para exibir o progresso da severidade da doença em função dos dias. Para isso, foi usado as funções `ggplot()` juntamente a `geom_point()` e `geom_line()`.\n\nTambém foram feitos gráficos separando os dados em função dos diferentes modos de irrigação utilizados no experimento.\n\n```{r}\ncurve |> \n  group_by(day) |> \n  summarise(severity_mean = mean(severity),\n            severity_sd = sd(severity)) |> \n  ggplot(aes(day, severity_mean))+\n  geom_point(width = 0.05)+\n  geom_line()\n\ncurve |> \n  group_by(day, Irrigation) |> \n  summarise(severity_mean = mean(severity),\n            severity_sd = sd(severity)) |> \n  ggplot(aes(day, severity_mean, color = Irrigation))+\n  geom_point(width = 0.05)+\n  geom_line()\n\ncurve |> \n  group_by(day, Irrigation) |> \n  summarise(severity_mean = mean(severity)) |> \n  ggplot(aes(day, severity_mean))+\n  geom_point(width = 0.05)+\n  geom_line()+\n  facet_grid(~Irrigation)\n```\n\n## AUDPC\n\nPara calcular a AUDPC (o mesmo que AACPD), foi usado o pacote `epifitter` junto com a função `summarise(AUDPC())`.\n\n```{r}\nlibrary(epifitter)\naudpc <- curve |> \n  group_by(Irrigation, rep) |> \n  summarise(aacpd = AUDPC(day, severity))\n```\n\n## ANOVA da AUDPC\n\nTendo os dados da AUDPC, o conjunto de dados foi ajustado para o modelo linear usando a função `lm()` e a fórmula `aacpd ~ Irrigation + factor(rep)`, na qual as repetições foram considerados como efeito fixo.\n\nPosteriormente, foi realizado uma análise de variância.\n\n```{r}\naov_audpc <- lm(aacpd ~ Irrigation + factor(rep),\n                data = audpc) \nanova(aov_audpc)\n```\n\nPelos resultados, percebe-se que tanto o modo de irrigação quanto as repetições tiveram efeitos pouco significativos em relação ao AUDPC.\n\nUsando os dados originais importados, foi também realizado uma ANOVA da severidade da doença em função do modo de irrigação interagindo com o fator dia, com as repetições novamente como efeito fixo.\n\n```{r}\naov_curve <- lm(severity ~ Irrigation*day + rep,\n         data = curve)\nanova(aov_curve)\n```\n\nObserva-se que o fator dia teve um efeito significativo sobre a severidade da doença, enquanto que os outros componentes não tiveram efeitos sobre a variável.\n\n### Coeficiente de variação\n\nO coeficiente de variação (CV) é um indicador da variabilidade de um conjunto de dados. Ele pode ser encontrado usando a função `cv.model()` do pacote `agricolae`.\n\n```{r}\nlibrary(agricolae)\ncv.model(aov_audpc)\n```\n\n# Parcela subdividida\n\nNo delineamento em parcelas subdivididas existem dois tipos de tratamento: o principal e o secundário. As parcelas são subdivididas no espaço, ou no tempo. Depois que os tratamentos principais (parcelas) são sorteados, sorteia-se o tratamento secundário (subparcelas) dentro das parcelas.\n\nOs tratamentos primários são distribuídos às parcelas de acordo com um delineamento especificado (efeito fixo).\n\nOs tratamentos secundários são distribuídos às subparcelas de forma aleatória (efeito aleatório).\n\nDesse modo, em delineamento de parcela subdivida é trabalhado um modelo misto: fator fixo + fator aleatório.\n\n## Importação dos dados\n\nO conjunto de dados foi importado a partir do Google Sheet através da função `gsheet2tbl()` do pacote `gsheet`.\n\nEsses dados representam podridão de Fusarium em milho em parcelas subdivididas. Dentro de cada bloco foi casualizado os híbridos (tratamento primário). O método de aplicação foi casualizado dentro dos híbridos (tratamento secundário).\n\n```{r}\nmilho <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=1345524759\")\n```\n\n## Visualização dos dados\n\nForam criados dois gráficos de pontos com intervalos de confiança, sendo um gráfico sobre o índice e outro sobre a produtividade. Os gráficos foram criados usando as funções `ggplot()`, `geom_jitter()` e `stat_summary` (para criar os pontos médios e intervalos de confiança)\n\n```{r}\nmilho |> \n  ggplot(aes(method, index))+\n  geom_jitter(width = 0.1, color = \"black\", alpha = 0.2)+\n  facet_grid(~hybrid)+\n  stat_summary(fun.data = \"mean_cl_boot\", color = \"blue\")\n\nmilho |> \n  ggplot(aes(method, yield))+\n  geom_jitter(width = 0.1, color = \"black\", alpha = 0.2)+\n  facet_grid(~hybrid)+\n  stat_summary(fun.data = \"mean_cl_boot\", color = \"red\")\n```\n\n## Modelo para parcela subdividida - index\n\nEm relação à variável resposta de índice, o modelo do conjunto de dados foi ajustado para o modelo misto usando a função `lmer()` do pacote `lme4`. Para atribuir os efeitos fixos e aleatórios, foi usado a seguinte fórmula: `index ~ hybrid*method + block + (1|block/hybrid)`, no qual os blocos estão como efeitos fixos e os híbridos como efeitos aleatórios.\n\n```{r}\nlibrary(lme4)\n\nmilho <- milho |> \n  mutate(block = as.factor(block))\n\nmix <- lmer(index ~ hybrid*method + block + (1|block/hybrid), \n             data = milho)\n```\n\nA análise de variância foi executada com a função `Anova()` do pacote `car`.\n\n```{r}\nlibrary(car)\nAnova(mix)\n```\n\nPode-se concluir que pelo menos um híbrido é diferente dos demais, assim como existe diferença significativa entre os métodos. A interação entre híbridos e métodos também resultou em uma diferença estatística.\n\n### Teste das premissas\n\n```{r}\ncheck_normality(mix)\ncheck_heteroscedasticity(mix)\n\nlibrary(DHARMa)\nplot(simulateResiduals(mix))\n```\n\nA premissa da homocedasticidade não foi atendida, sendo necessário realizar transformação dos dados.\n\n### Transformação com raiz quadrada\n\n```{r}\nmix2 <- lmer(sqrt(index) ~ hybrid*method + block + (1|block/hybrid), \n             data = milho)\nAnova(mix2)\ncheck_normality(mix2)\ncheck_heteroscedasticity(mix2)\nplot(simulateResiduals(mix2))\n\nqqnorm(residuals(mix2))\nqqline(residuals(mix2))\nhist(residuals(mix2))\n```\n\nDessa vez as premissas foram atendidas.\n\n### Comparação das médias entre os grupos\n\nO teste de comparação das médias entre os grupos foi realizado com as funções `emmeans()` e `cld()`.\n\nComo a interação entre híbridos e métodos deu um valor significativo, o teste de comparação das médias foi tanta sobre os híbridos em função dos métodos, quando dos métodos em função dos híbridos.\n\n```{r}\nmedias_milho <- emmeans(mix2,\n                        ~hybrid|method,\n                        type = \"response\") #Qaundo transforma dados, precisa colocar type = response\nmedias_milho2 <- emmeans(mix2,\n                         ~method|hybrid,\n                         type = \"response\")\n\ncld(medias_milho, Letters = LETTERS)\ncld(medias_milho2, Letters = letters)\n```\n\n## Modelo para parcela subdividida - yield\n\nOs mesmos processos foram repetidos para a variável resposta produtividade.\n\n```{r}\nmix3 <- lmer(sqrt(yield) ~ hybrid*method + block + (1|block/hybrid), \n             data = milho)\nAnova(mix3)\n```\n\nPelo menos um híbrido é diferente dos demais, assim como existe diferença significativa na interação híbrido com método\n\n### Teste das premissas\n\n```{r}\ncheck_normality(mix3)\ncheck_heteroscedasticity(mix3)\n```\n\nAs premissas foram atendidas.\n\n### Comparação das médias entre os grupos\n\n```{r}\nmedias_milho3 <- emmeans(mix3,\n                        ~hybrid|method) \nmedias_milho4 <- emmeans(mix3,\n                         ~method|hybrid)\n\ncld(medias_milho3, Letters = LETTERS)\ncld(medias_milho4, Letters = letters)\n```\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"Aula8_quarto.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.353","editor":"visual","theme":{"light":"flatly","dark":"darkly"},"title":"ANOVA em blocos casualizados e parcela subdividida","message":false},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}