{"title":"Análise exploratória 1","markdown":{"yaml":{"title":"Análise exploratória 1","format":"html","message":false,"warning":false},"headingText":"Criação de gráficos","containsRefs":false,"markdown":"\n\n\nApós a importação de um conjunto de dados, uma **análise exploratória** com montagem de gráficos pode ser feita com o objetivo de analisar e resumir os dados. Para a criação do gráfico, pode ser usada a função `ggplot()` do pacote `tidyverse`. Dentro dessa função, é possível ir modificando o gráfico como desejar por meio dos seus argumentos. Usa-se o argumento `aes()`para especificar qual das variáveis irá compor o eixo X e eixo Y do gráfico. Por exemplo, ao colocar `aes(trat,comp)` está especificando que a variável `trat` representará o eixo X e a variável `comp` representará o eixo Y.\n\nPara continuar adicionando funções dentro de um mesmo pipe, deve-se colocar o sinal `+`. O tipo de gráfico que será criado dependerá da função `geom_`, podendo ser um gráfico de pontos se usar `geom_point()` ou um gráfico boxplot se usar `geom_boxplot()`. Há também vários outros tipos que podem ser utilizados dependendo da função.\n\n# Tipos de gráficos\n\n-   **Gráfico de pontos**: Os pontos são usados para representar cada valor da variável resposta em função do eixo X, que pode ser um fator numérico ou categórico. Esse tipo de gráfico pode ser formado pelas funções `geom_point()` ou `geom_jitter()`.\n\n-   **Gráfico de colunas ou barras**: Os gráficos de barras ou colunas são uma forma de representar valores numéricos associados a categorias. Podem ser usados para representar frequências de fatores. A função `geom_col()` é usada para criar esse tipo de gráfico.\n\n-   **Gráfico de dispersão**: Representam uma (ou várias) variáveis numéricas (ditas dependentes) no eixo Y em função de outra no eixo X (dita independente). Esse tipo de gráfico pode ser formado pela função `geom_point()`.\n\n-   **Gráfico boxplot**: Os boxplots servem para visualizar a distribuição de valores de uma variável numérica mostrando algumas medidas de estatística descritiva de forma gráfica. O boxplot típico é formado por uma linha central que representa a mediana, uma zona retangular cujo lado superior é dado pelo terceiro quartil e o inferior pelo primeiro quartil e um traço superior e inferior que representam, respectivamente, os valores máximos e mínimos. O boxplot é criado usando a função `geom_boxplot()`.\n\n-   **Histograma**: Os histogramas são gráficos bastante simples que permitem caracterizar a distribuição de frequência de valores de uma variável. Nos histogramas, a altura de cada retângulo é proporcional ao número de observações do intervalo de valores na base. O histograma pode ser criado usando a função `geom_histogram()`.\n\n-   **Gráfico de linhas**: Muito comum para uma resposta numérica contínua em um fator quantitativo (como dose) ou temporal (de tempo). Para esse gráfico é usado a função `geom_line()`.\n\n-   **Gráfico errorbar**: Gráfico de pontos ou de colunas que apresentam uma faixa de variabilidade ou barra de erro. Essa variabilidade por ser desvio padrão, erro padrão ou intervalo de confiança. Pode ser criado usando a função `geom_errorbar()`\n\n# Conjunto de dados 1\n\nNesse primeiro conjunto de dados (importado a partir do Google Sheets), está sendo trabalhado uma variável resposta (comprimento de plantas) em função de dois tratamentos diferentes: a aplicação de Mg2 e o controle (sem aplicação de Mg2).\n\nO primeiro passo é a importação dos dados e o carregamento dos pacotes que serão utilizados.\n\n```{r}\nlibrary(tidyverse)\nlibrary(gsheet)\n\ndados <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=983033137#gid=983033137\")\n```\n\nCom esse conjunto de dados, pode-se trabalhar com 2 análises exploratórias diferentes: o gráfico de pontos e o boxplot.\n\n## Trabalhando com o gráfico de pontos\n\nDentro da função `geom_point`, determina-se a cor dos pontos com o argumento `color =`, o formato dos pontos com o argumento `shape =` e o tamanho dos pontos com o argumento `size =`.\n\n```{r}\ng1 <- dados|>\n  ggplot(aes(trat, comp))+\n  geom_point(color = \"black\", shape = 2, size = 3)\ng1\n```\n\n### Temas e legendas\n\nOutras adições que podem ser feitas com o gráfico é modificar o seu tema e adicionar títulos e legendas. Existem diversas funções para modificar o tema do gráfico, entre eles o `theme_classic()` ou então o `theme_bw()`. Para adicionar algum texto no gráfico, usa-se a função `labs()`, com isso pode-se adicionar um nome para o eixo X e para o eixo Y e também adicionar um título para o gráfico e uma legenda.\n\n```{r}\ng1 + theme_classic() +\n  labs(x = \"Tratamento\",\n       y = \"Comprimento\",\n       title = \"Meu primeiro ggplot\",\n       caption = \"Fonte: Dados diversos\")\n```\n\n## Trabalhando com boxplot\n\nAlém do `geom_point()` é possível usar também o `geom_boxplot()` para criar um gráfico boxplot ou o `geom_jitter()` para criar um gráfico de pontos separados, não agrupados. No `geom_boxplot()` tem os argumentos `outlier.colour = NA` para não duplicar o outlier e o `fill =` para adicionar uma cor ao quadrado do boxplot.\n\nNo `geom_jitter()` pode ser usado os argumentos `width =` para modificar a largura, `color =` para mudar a cor, `shape =` para mudar o formato e `size =` para mudar o tamanho dos pontos.\n\nAs funções `ylim()` e `scale_y_continuous()` podem ser usados para definir ou delimitar os valores que aparecem no eixo Y.\n\n```{r}\ng2 <- dados |> \n  ggplot(aes(trat, comp))+\n  geom_boxplot(outlier.colour = NA,\n               fill = \"orange\")+\n  geom_jitter(width = 0.05, \n              color = \"black\",\n              shape = 1,\n              size = 3) \n\ng2 + theme_classic()+\n  labs(x = \"Tratamento\",\n       y = \"Comprimento (mm)\",\n       title = \"Meu primeiro ggplot\",\n       caption = \"Fonte: Dados diversos\")+\n  ylim(0,20) +\n  scale_y_continuous(limits = c(0,20),\n                     n.breaks = 10)\n```\n\n# Conjunto de dados 2\n\nO segundo conjunto de dados está em um link na web no formato *csv*, que foi importado usando a função `read_csv()`.\n\nPara uma breve descrição dos conteúdos do dado, pode ser usado a função `glimpse()`.\n\n```{r}\ncr <- read_csv(\"https://raw.githubusercontent.com/emdelponte/paper-coffee-rust-Ethiopia/master/data/survey_clean.csv\")\n\nglimpse(cr)\n```\n\nPode-se observar que o trabalho envolve a incidência e severidade da doença da ferrugem do café em 405 fazendas diferentes. A incidência é a presença ou ausência da doença no material que foi amostrado, enquanto que a severidade é a quantidade de doença presente na amostra com incidência positiva.\n\nEsse conjunto de dados envolve 2 principais fatores: a região (SNNPR e Oromia) e a cultivar (Improved, Mixture e Local).\n\nA análise exploratória pode ser trabalhada com as duas variáveis respostas.\n\n## Trabalhando com histogramas sobre a incidência\n\nPara visualizar esse conjunto de dados, pode ser feito uma análise exploratória utilizando o histograma. O histograma serve para visualizar uma distribuição contínua apresentado as frequências de determinados resultados. Para criar o histograma, usa-se a função `ggplot()` juntamente com `geom_histogram()`. Como o conjunto de dados se refere a 2 regiões diferentes, pode-se realizar um histograma por região usando o `facet_wrap(~region)`, dessa forma as duas regiões ficam separadas.\n\n```{r}\ncr |> \n  ggplot(aes(x = inc))+\n  geom_histogram()+\n  facet_wrap(~region)\n```\n\n## Trabalhando com boxplot sobre a incidência\n\nTambém pode ser observado os dados através de um gráfico em boxplot. Cria-se esse gráfico com a função `geom_boxplot()`. O boxplot irá fornecer a variação de dados observados de uma variável numérica por meio de quartis, sendo que a caixa é delimitada pelo primeiro e terceiro quartil e a linha dentro da caixa representa a mediana.\n\nOs valores da mediana e do primeiro e terceiro quartil podem ser encontrados através da função `summary()`.\n\n```{r}\ncr |> \n  ggplot(aes(y = inc))+\n  geom_boxplot()\n\nsummary(cr$inc)\n```\n\n## Sumário da incidência\n\nPara observar valores como média, desvio padrão e mediana, pode ser usado a função `summerise()`e os argumentos `mean()`, `sd()` e `median()`. Mas antes disso, será agrupado os dados pela região, separando dessa forma as duas regiões diferentes novamente. Isso pode ser feito com a função `group_by()`.\n\n```{r}\ncr |> \n  group_by(region) |> \n  summarise(inc_mean = mean(inc),\n            sd_mean = sd(inc),\n            inc_med = median(inc))\n```\n\nPosteriormente, também foi feito a sumarização agrupando os dados à nível de cultivar.\n\n```{r}\ncr |> \n  group_by(cultivar) |> \n  summarise(inc_mean = mean(inc),\n            sd_mean = sd(inc),\n            inc_med = median(inc))\n```\n\n## Trabalhando com gráfico de dispersão entre incidência e severidade\n\nTambém pode ser criado um gráfico de dispersão para mostrar a relação entre incidência e severidade, usando a função `geom_point()`. O gráfico de dispersão de pontos é um tipo de gráfico que pode ser utilizado quando as variáveis X e Y são contínuas e apresentam relação entre as respostas.\n\n```{r}\ncr |> \n  ggplot(aes(inc, sev2))+\n  geom_point()\n```\n\nPor meio desse gráfico, é possível observar que conforme a incidência aumenta, a severidade também aumenta.\n\n## Trabalhando com histogramas e sumário de severidade\n\nDo mesmo modo, foi feito um histograma sobre a variável severidade separando as duas regiões.\n\n```{r}\ncr |> \n  ggplot(aes(x = sev2))+\n  geom_histogram()+\n  facet_wrap(~region)\n```\n\nTambém foi feito a sumarização da severidade agrupando os dados à nível de cultivar.\n\n```{r}\ncr |> \n  group_by(cultivar) |> \n  summarise(sev_mean = mean(sev2),\n            sev_sd = sd(sev2),\n            sev_med = median(sev2))\n```\n\nAo criar um histograma sobre a variável severidade agrupando os dados em função da cultivar, pode-se notar que a distribuição da severidade é mais simétrica\n\n```{r}\ncr |> \n  ggplot(aes(x = sev2))+\n  geom_histogram()+\n  facet_wrap(~cultivar)\n```\n\n## Trabalhando com histograma sobre severidade por região e cultivar\n\nPara comparar os histogramas de severidade agrupados por região e por cultivar, pode-se colocar o argumento `facet_grid(region ~ cultivar)`. Desse modo, ele irá criar um histograma para cada relação entre os níveis de região e cultivar.\n\nNo gráfico abaixo foi utilizado a função `scale_fill_colorblind()` do pacote `ggthemes` para adicionar cores ao gráfico.\n\n```{r}\nlibrary(ggthemes)\n\ncr |> \n  ggplot(aes(x = sev2, fill = region))+\n  geom_histogram(color = \"white\")+\n  facet_grid(region ~ cultivar)+\n  scale_fill_colorblind()+\n  theme_minimal(base_size = 14)+\n  theme(legend.position = \"bottom\")+\n  labs(y = \"Frequency\",\n       x = \"Severity (%)\", fill = \"Region\")\n```\n\n## Criando subconjuntos com select e filter\n\nA função `select()` é feita para selecionar colunas, enquanto a função `filter()` é feita para filtrar linhas. Usando essas funções do pacote `dplyr`, será criado subconjuntos: o primeiro irá agrupar os dados sobre as fazendas, cultivares e severidade referentes à região de Oromia enquanto que o segundo irá agrupar essas mesmas informações referentes à região de SNNPR.\n\n```{r}\n# Subconjunto Oromia\ncr_oromia <- cr |> \n  select(farm, region, cultivar, sev2) |> \n  filter(region == \"Oromia\")\ncr_oromia\n\n# Subconjunto SNNPR\ncr_pr <- cr |> \n  select(farm, region, cultivar, sev2) |> \n  filter(region == \"SNNPR\")\ncr_pr\n```\n\n## Visualização dos subconjuntos\n\nTendo criado os subconjuntos, foi feito um gráfico boxplot para a visualização de cada um deles.\n\n```{r}\np1 <- cr_oromia |> \n  ggplot(aes(cultivar, sev2, fill = cultivar))+\n  geom_boxplot()+\n  coord_flip()+\n  labs(x = \"Cultivar\",\n       y = \"Severity (%)\")\np1\n\np2 <- cr_pr |> \n  ggplot(aes(cultivar, sev2, fill = cultivar))+\n  geom_boxplot()+\n  coord_flip()+\n  labs(x = \"Cultivar\",\n       y = \"Severity (%)\")\np2\n```\n\n## Juntando gráficos com o patchwork\n\nAtravés do pacote `patchwork`, é possível juntar dois ou mais gráficos em uma única imagem. Os gráficos podem ficar um do lado do outro\n\n```{r}\nlibrary(patchwork)\n\np1 + p2\n```\n\nOu também um em cima do outro.\n\n```{r}\np1 / p2\n```\n\nPara que os gráficos compartilhem a mesma legenda e o mesmo nome dos eixos, pode ser usado as funções `plot_layout()` e `plot_annotation()`.\n\n```{r}\n(p1 / p2) + \n  plot_layout(guides = \"collect\",\n              axes = \"collect\")+\n  plot_annotation(tag_levels = 'A')\n```\n\nAdicionando as funções `theme_few()` e `scale_fill_few()` é possível alterar o tema e as cores do gráfico.\n\n```{r}\np11 <- cr_oromia |> \n  ggplot(aes(cultivar, sev2, fill = cultivar))+\n  geom_boxplot()+\n  theme_few()+           #Para mudar o formato/estilo do gráfico\n  scale_fill_few()+   #Para mudar a cor\n  coord_flip()+\n  labs(x = \"Cultivar\",\n       y = \"Severity (%)\")\np11\n\np22 <- cr_pr |> \n  ggplot(aes(cultivar, sev2, fill = cultivar))+\n  geom_boxplot()+\n  theme_few()+           #Para mudar o formato/estilo do gráfico\n  scale_fill_few()+   #Para mudar a cor\n  coord_flip()+\n  labs(x = \"Cultivar\",\n       y = \"Severity (%)\")\np22\n```\n\nColocando título e fonte na imagem.\n\n```{r}\n(p11 / p22) + \n  plot_layout(guides = \"collect\",\n              axes = \"collect\")+\n  plot_annotation(title = \"Coffe rust in Ethiopia\",\n                  caption = \"Source: Del Ponte (2022)\",\n                  tag_levels = 'A')\n```\n\n## Colocando um gráfico dentro de outro\n\nUsando ainda o pacote `patchwork`, é possível inserir um gráfico dentro de outro gráfico.\n\n```{r}\np3 <- cr_oromia |> \n  ggplot(aes(x = sev2))+\n  geom_histogram()\n\np1 + inset_element(p3, left = 0.6, bottom = 0.6, right = 1, top = 1)\n\n```\n\n# Salvar imagens\n\nPara salvar o último gráfico rodado no R, pode-se utilizar a função `ggsave()` especificando o nome com que o arquivo será salvo e a cor de fundo da imagem. A imagem será salva dentro da pasta contendo o RStudio Project.\n\n```{r}\ng1 + theme_classic()+\n  labs(x = \"Tratamento\",\n       y = \"Comprimento (mm)\",\n       title = \"Meu primeiro ggplot\",\n       caption = \"Fonte: Dados diversos\")+\n  scale_y_continuous(limits = c(0,20),\n                     n.breaks = 10)\nggsave(\"plot1.png\", bg = \"white\")\n```\n","srcMarkdownNoYaml":"\n\n# Criação de gráficos\n\nApós a importação de um conjunto de dados, uma **análise exploratória** com montagem de gráficos pode ser feita com o objetivo de analisar e resumir os dados. Para a criação do gráfico, pode ser usada a função `ggplot()` do pacote `tidyverse`. Dentro dessa função, é possível ir modificando o gráfico como desejar por meio dos seus argumentos. Usa-se o argumento `aes()`para especificar qual das variáveis irá compor o eixo X e eixo Y do gráfico. Por exemplo, ao colocar `aes(trat,comp)` está especificando que a variável `trat` representará o eixo X e a variável `comp` representará o eixo Y.\n\nPara continuar adicionando funções dentro de um mesmo pipe, deve-se colocar o sinal `+`. O tipo de gráfico que será criado dependerá da função `geom_`, podendo ser um gráfico de pontos se usar `geom_point()` ou um gráfico boxplot se usar `geom_boxplot()`. Há também vários outros tipos que podem ser utilizados dependendo da função.\n\n# Tipos de gráficos\n\n-   **Gráfico de pontos**: Os pontos são usados para representar cada valor da variável resposta em função do eixo X, que pode ser um fator numérico ou categórico. Esse tipo de gráfico pode ser formado pelas funções `geom_point()` ou `geom_jitter()`.\n\n-   **Gráfico de colunas ou barras**: Os gráficos de barras ou colunas são uma forma de representar valores numéricos associados a categorias. Podem ser usados para representar frequências de fatores. A função `geom_col()` é usada para criar esse tipo de gráfico.\n\n-   **Gráfico de dispersão**: Representam uma (ou várias) variáveis numéricas (ditas dependentes) no eixo Y em função de outra no eixo X (dita independente). Esse tipo de gráfico pode ser formado pela função `geom_point()`.\n\n-   **Gráfico boxplot**: Os boxplots servem para visualizar a distribuição de valores de uma variável numérica mostrando algumas medidas de estatística descritiva de forma gráfica. O boxplot típico é formado por uma linha central que representa a mediana, uma zona retangular cujo lado superior é dado pelo terceiro quartil e o inferior pelo primeiro quartil e um traço superior e inferior que representam, respectivamente, os valores máximos e mínimos. O boxplot é criado usando a função `geom_boxplot()`.\n\n-   **Histograma**: Os histogramas são gráficos bastante simples que permitem caracterizar a distribuição de frequência de valores de uma variável. Nos histogramas, a altura de cada retângulo é proporcional ao número de observações do intervalo de valores na base. O histograma pode ser criado usando a função `geom_histogram()`.\n\n-   **Gráfico de linhas**: Muito comum para uma resposta numérica contínua em um fator quantitativo (como dose) ou temporal (de tempo). Para esse gráfico é usado a função `geom_line()`.\n\n-   **Gráfico errorbar**: Gráfico de pontos ou de colunas que apresentam uma faixa de variabilidade ou barra de erro. Essa variabilidade por ser desvio padrão, erro padrão ou intervalo de confiança. Pode ser criado usando a função `geom_errorbar()`\n\n# Conjunto de dados 1\n\nNesse primeiro conjunto de dados (importado a partir do Google Sheets), está sendo trabalhado uma variável resposta (comprimento de plantas) em função de dois tratamentos diferentes: a aplicação de Mg2 e o controle (sem aplicação de Mg2).\n\nO primeiro passo é a importação dos dados e o carregamento dos pacotes que serão utilizados.\n\n```{r}\nlibrary(tidyverse)\nlibrary(gsheet)\n\ndados <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=983033137#gid=983033137\")\n```\n\nCom esse conjunto de dados, pode-se trabalhar com 2 análises exploratórias diferentes: o gráfico de pontos e o boxplot.\n\n## Trabalhando com o gráfico de pontos\n\nDentro da função `geom_point`, determina-se a cor dos pontos com o argumento `color =`, o formato dos pontos com o argumento `shape =` e o tamanho dos pontos com o argumento `size =`.\n\n```{r}\ng1 <- dados|>\n  ggplot(aes(trat, comp))+\n  geom_point(color = \"black\", shape = 2, size = 3)\ng1\n```\n\n### Temas e legendas\n\nOutras adições que podem ser feitas com o gráfico é modificar o seu tema e adicionar títulos e legendas. Existem diversas funções para modificar o tema do gráfico, entre eles o `theme_classic()` ou então o `theme_bw()`. Para adicionar algum texto no gráfico, usa-se a função `labs()`, com isso pode-se adicionar um nome para o eixo X e para o eixo Y e também adicionar um título para o gráfico e uma legenda.\n\n```{r}\ng1 + theme_classic() +\n  labs(x = \"Tratamento\",\n       y = \"Comprimento\",\n       title = \"Meu primeiro ggplot\",\n       caption = \"Fonte: Dados diversos\")\n```\n\n## Trabalhando com boxplot\n\nAlém do `geom_point()` é possível usar também o `geom_boxplot()` para criar um gráfico boxplot ou o `geom_jitter()` para criar um gráfico de pontos separados, não agrupados. No `geom_boxplot()` tem os argumentos `outlier.colour = NA` para não duplicar o outlier e o `fill =` para adicionar uma cor ao quadrado do boxplot.\n\nNo `geom_jitter()` pode ser usado os argumentos `width =` para modificar a largura, `color =` para mudar a cor, `shape =` para mudar o formato e `size =` para mudar o tamanho dos pontos.\n\nAs funções `ylim()` e `scale_y_continuous()` podem ser usados para definir ou delimitar os valores que aparecem no eixo Y.\n\n```{r}\ng2 <- dados |> \n  ggplot(aes(trat, comp))+\n  geom_boxplot(outlier.colour = NA,\n               fill = \"orange\")+\n  geom_jitter(width = 0.05, \n              color = \"black\",\n              shape = 1,\n              size = 3) \n\ng2 + theme_classic()+\n  labs(x = \"Tratamento\",\n       y = \"Comprimento (mm)\",\n       title = \"Meu primeiro ggplot\",\n       caption = \"Fonte: Dados diversos\")+\n  ylim(0,20) +\n  scale_y_continuous(limits = c(0,20),\n                     n.breaks = 10)\n```\n\n# Conjunto de dados 2\n\nO segundo conjunto de dados está em um link na web no formato *csv*, que foi importado usando a função `read_csv()`.\n\nPara uma breve descrição dos conteúdos do dado, pode ser usado a função `glimpse()`.\n\n```{r}\ncr <- read_csv(\"https://raw.githubusercontent.com/emdelponte/paper-coffee-rust-Ethiopia/master/data/survey_clean.csv\")\n\nglimpse(cr)\n```\n\nPode-se observar que o trabalho envolve a incidência e severidade da doença da ferrugem do café em 405 fazendas diferentes. A incidência é a presença ou ausência da doença no material que foi amostrado, enquanto que a severidade é a quantidade de doença presente na amostra com incidência positiva.\n\nEsse conjunto de dados envolve 2 principais fatores: a região (SNNPR e Oromia) e a cultivar (Improved, Mixture e Local).\n\nA análise exploratória pode ser trabalhada com as duas variáveis respostas.\n\n## Trabalhando com histogramas sobre a incidência\n\nPara visualizar esse conjunto de dados, pode ser feito uma análise exploratória utilizando o histograma. O histograma serve para visualizar uma distribuição contínua apresentado as frequências de determinados resultados. Para criar o histograma, usa-se a função `ggplot()` juntamente com `geom_histogram()`. Como o conjunto de dados se refere a 2 regiões diferentes, pode-se realizar um histograma por região usando o `facet_wrap(~region)`, dessa forma as duas regiões ficam separadas.\n\n```{r}\ncr |> \n  ggplot(aes(x = inc))+\n  geom_histogram()+\n  facet_wrap(~region)\n```\n\n## Trabalhando com boxplot sobre a incidência\n\nTambém pode ser observado os dados através de um gráfico em boxplot. Cria-se esse gráfico com a função `geom_boxplot()`. O boxplot irá fornecer a variação de dados observados de uma variável numérica por meio de quartis, sendo que a caixa é delimitada pelo primeiro e terceiro quartil e a linha dentro da caixa representa a mediana.\n\nOs valores da mediana e do primeiro e terceiro quartil podem ser encontrados através da função `summary()`.\n\n```{r}\ncr |> \n  ggplot(aes(y = inc))+\n  geom_boxplot()\n\nsummary(cr$inc)\n```\n\n## Sumário da incidência\n\nPara observar valores como média, desvio padrão e mediana, pode ser usado a função `summerise()`e os argumentos `mean()`, `sd()` e `median()`. Mas antes disso, será agrupado os dados pela região, separando dessa forma as duas regiões diferentes novamente. Isso pode ser feito com a função `group_by()`.\n\n```{r}\ncr |> \n  group_by(region) |> \n  summarise(inc_mean = mean(inc),\n            sd_mean = sd(inc),\n            inc_med = median(inc))\n```\n\nPosteriormente, também foi feito a sumarização agrupando os dados à nível de cultivar.\n\n```{r}\ncr |> \n  group_by(cultivar) |> \n  summarise(inc_mean = mean(inc),\n            sd_mean = sd(inc),\n            inc_med = median(inc))\n```\n\n## Trabalhando com gráfico de dispersão entre incidência e severidade\n\nTambém pode ser criado um gráfico de dispersão para mostrar a relação entre incidência e severidade, usando a função `geom_point()`. O gráfico de dispersão de pontos é um tipo de gráfico que pode ser utilizado quando as variáveis X e Y são contínuas e apresentam relação entre as respostas.\n\n```{r}\ncr |> \n  ggplot(aes(inc, sev2))+\n  geom_point()\n```\n\nPor meio desse gráfico, é possível observar que conforme a incidência aumenta, a severidade também aumenta.\n\n## Trabalhando com histogramas e sumário de severidade\n\nDo mesmo modo, foi feito um histograma sobre a variável severidade separando as duas regiões.\n\n```{r}\ncr |> \n  ggplot(aes(x = sev2))+\n  geom_histogram()+\n  facet_wrap(~region)\n```\n\nTambém foi feito a sumarização da severidade agrupando os dados à nível de cultivar.\n\n```{r}\ncr |> \n  group_by(cultivar) |> \n  summarise(sev_mean = mean(sev2),\n            sev_sd = sd(sev2),\n            sev_med = median(sev2))\n```\n\nAo criar um histograma sobre a variável severidade agrupando os dados em função da cultivar, pode-se notar que a distribuição da severidade é mais simétrica\n\n```{r}\ncr |> \n  ggplot(aes(x = sev2))+\n  geom_histogram()+\n  facet_wrap(~cultivar)\n```\n\n## Trabalhando com histograma sobre severidade por região e cultivar\n\nPara comparar os histogramas de severidade agrupados por região e por cultivar, pode-se colocar o argumento `facet_grid(region ~ cultivar)`. Desse modo, ele irá criar um histograma para cada relação entre os níveis de região e cultivar.\n\nNo gráfico abaixo foi utilizado a função `scale_fill_colorblind()` do pacote `ggthemes` para adicionar cores ao gráfico.\n\n```{r}\nlibrary(ggthemes)\n\ncr |> \n  ggplot(aes(x = sev2, fill = region))+\n  geom_histogram(color = \"white\")+\n  facet_grid(region ~ cultivar)+\n  scale_fill_colorblind()+\n  theme_minimal(base_size = 14)+\n  theme(legend.position = \"bottom\")+\n  labs(y = \"Frequency\",\n       x = \"Severity (%)\", fill = \"Region\")\n```\n\n## Criando subconjuntos com select e filter\n\nA função `select()` é feita para selecionar colunas, enquanto a função `filter()` é feita para filtrar linhas. Usando essas funções do pacote `dplyr`, será criado subconjuntos: o primeiro irá agrupar os dados sobre as fazendas, cultivares e severidade referentes à região de Oromia enquanto que o segundo irá agrupar essas mesmas informações referentes à região de SNNPR.\n\n```{r}\n# Subconjunto Oromia\ncr_oromia <- cr |> \n  select(farm, region, cultivar, sev2) |> \n  filter(region == \"Oromia\")\ncr_oromia\n\n# Subconjunto SNNPR\ncr_pr <- cr |> \n  select(farm, region, cultivar, sev2) |> \n  filter(region == \"SNNPR\")\ncr_pr\n```\n\n## Visualização dos subconjuntos\n\nTendo criado os subconjuntos, foi feito um gráfico boxplot para a visualização de cada um deles.\n\n```{r}\np1 <- cr_oromia |> \n  ggplot(aes(cultivar, sev2, fill = cultivar))+\n  geom_boxplot()+\n  coord_flip()+\n  labs(x = \"Cultivar\",\n       y = \"Severity (%)\")\np1\n\np2 <- cr_pr |> \n  ggplot(aes(cultivar, sev2, fill = cultivar))+\n  geom_boxplot()+\n  coord_flip()+\n  labs(x = \"Cultivar\",\n       y = \"Severity (%)\")\np2\n```\n\n## Juntando gráficos com o patchwork\n\nAtravés do pacote `patchwork`, é possível juntar dois ou mais gráficos em uma única imagem. Os gráficos podem ficar um do lado do outro\n\n```{r}\nlibrary(patchwork)\n\np1 + p2\n```\n\nOu também um em cima do outro.\n\n```{r}\np1 / p2\n```\n\nPara que os gráficos compartilhem a mesma legenda e o mesmo nome dos eixos, pode ser usado as funções `plot_layout()` e `plot_annotation()`.\n\n```{r}\n(p1 / p2) + \n  plot_layout(guides = \"collect\",\n              axes = \"collect\")+\n  plot_annotation(tag_levels = 'A')\n```\n\nAdicionando as funções `theme_few()` e `scale_fill_few()` é possível alterar o tema e as cores do gráfico.\n\n```{r}\np11 <- cr_oromia |> \n  ggplot(aes(cultivar, sev2, fill = cultivar))+\n  geom_boxplot()+\n  theme_few()+           #Para mudar o formato/estilo do gráfico\n  scale_fill_few()+   #Para mudar a cor\n  coord_flip()+\n  labs(x = \"Cultivar\",\n       y = \"Severity (%)\")\np11\n\np22 <- cr_pr |> \n  ggplot(aes(cultivar, sev2, fill = cultivar))+\n  geom_boxplot()+\n  theme_few()+           #Para mudar o formato/estilo do gráfico\n  scale_fill_few()+   #Para mudar a cor\n  coord_flip()+\n  labs(x = \"Cultivar\",\n       y = \"Severity (%)\")\np22\n```\n\nColocando título e fonte na imagem.\n\n```{r}\n(p11 / p22) + \n  plot_layout(guides = \"collect\",\n              axes = \"collect\")+\n  plot_annotation(title = \"Coffe rust in Ethiopia\",\n                  caption = \"Source: Del Ponte (2022)\",\n                  tag_levels = 'A')\n```\n\n## Colocando um gráfico dentro de outro\n\nUsando ainda o pacote `patchwork`, é possível inserir um gráfico dentro de outro gráfico.\n\n```{r}\np3 <- cr_oromia |> \n  ggplot(aes(x = sev2))+\n  geom_histogram()\n\np1 + inset_element(p3, left = 0.6, bottom = 0.6, right = 1, top = 1)\n\n```\n\n# Salvar imagens\n\nPara salvar o último gráfico rodado no R, pode-se utilizar a função `ggsave()` especificando o nome com que o arquivo será salvo e a cor de fundo da imagem. A imagem será salva dentro da pasta contendo o RStudio Project.\n\n```{r}\ng1 + theme_classic()+\n  labs(x = \"Tratamento\",\n       y = \"Comprimento (mm)\",\n       title = \"Meu primeiro ggplot\",\n       caption = \"Fonte: Dados diversos\")+\n  scale_y_continuous(limits = c(0,20),\n                     n.breaks = 10)\nggsave(\"plot1.png\", bg = \"white\")\n```\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"Aula4_quarto.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.353","editor":"visual","theme":{"light":"flatly","dark":"darkly"},"title":"Análise exploratória 1","message":false},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}