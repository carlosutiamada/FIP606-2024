<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>FIP606-24 - ANOVA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./favicon.jpg" rel="icon" type="image/jpeg">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">FIP606-24</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target=""><i class="bi bi-house" role="img">
</i> 
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-sobre-o-r" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
      <i class="bi bi-r-circle-fill" role="img">
</i> 
 <span class="menu-text">Sobre o R</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-sobre-o-r">    
        <li>
    <a class="dropdown-item" href="./Aula1_quarto.html" rel="" target="">
 <span class="dropdown-text">Introdução ao R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Aula2_quarto.html" rel="" target="">
 <span class="dropdown-text">Pacotes</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Aula3_quarto.html" rel="" target="">
 <span class="dropdown-text">Importação de dados</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-análise-exploratória" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
      <i class="bi bi-bar-chart" role="img">
</i> 
 <span class="menu-text">Análise exploratória</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-análise-exploratória">    
        <li>
    <a class="dropdown-item" href="./Aula4_quarto.html" rel="" target="">
 <span class="dropdown-text">Análise exploratória 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Aula5_quarto.html" rel="" target="">
 <span class="dropdown-text">Análise exploratória 2</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-análise-estatística" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
      <i class="bi bi-clipboard-data" role="img">
</i> 
 <span class="menu-text">Análise estatística</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-análise-estatística">    
        <li>
    <a class="dropdown-item" href="./Aula6_quarto.html" rel="" target="">
 <span class="dropdown-text">Teste-t</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Aula7_quarto.html" rel="" target="">
 <span class="dropdown-text">ANOVA</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Aula8_quarto.html" rel="" target="">
 <span class="dropdown-text">ANOVA em blocos casualizados</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Aula9_quarto.html" rel="" target="">
 <span class="dropdown-text">Regressão</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Aula10_quarto.html" rel="" target="">
 <span class="dropdown-text">Correlação</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./Aula11_quarto.html" rel="" target=""><i class="bi bi-map" role="img">
</i> 
 <span class="menu-text">Mapas</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/carlosutiamada" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/carlosakirautiamada/" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.instagram.com/carlos.akira.utiamada/" rel="" target=""><i class="bi bi-instagram" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#teste-de-hipótese-de-três-ou-mais-grupos-independentes" id="toc-teste-de-hipótese-de-três-ou-mais-grupos-independentes" class="nav-link active" data-scroll-target="#teste-de-hipótese-de-três-ou-mais-grupos-independentes">Teste de hipótese de três ou mais grupos independentes</a>
  <ul class="collapse">
  <li><a href="#importação-dos-dados" id="toc-importação-dos-dados" class="nav-link" data-scroll-target="#importação-dos-dados">Importação dos dados</a></li>
  <li><a href="#visualização-dos-dados" id="toc-visualização-dos-dados" class="nav-link" data-scroll-target="#visualização-dos-dados">Visualização dos dados</a></li>
  <li><a href="#anova" id="toc-anova" class="nav-link" data-scroll-target="#anova">ANOVA</a></li>
  <li><a href="#teste-de-tukey" id="toc-teste-de-tukey" class="nav-link" data-scroll-target="#teste-de-tukey">Teste de Tukey</a></li>
  <li><a href="#teste-das-premissas" id="toc-teste-das-premissas" class="nav-link" data-scroll-target="#teste-das-premissas">Teste das premissas</a>
  <ul class="collapse">
  <li><a href="#checando-as-premissas-pelo-pacote-dharma" id="toc-checando-as-premissas-pelo-pacote-dharma" class="nav-link" data-scroll-target="#checando-as-premissas-pelo-pacote-dharma">Checando as premissas pelo pacote DHARMa</a></li>
  <li><a href="#checando-as-premissas-pelo-pacote-performance" id="toc-checando-as-premissas-pelo-pacote-performance" class="nav-link" data-scroll-target="#checando-as-premissas-pelo-pacote-performance">Checando as premissas pelo pacote performance</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#anova-de-dados-não-paramétricos" id="toc-anova-de-dados-não-paramétricos" class="nav-link" data-scroll-target="#anova-de-dados-não-paramétricos">ANOVA de dados não-paramétricos</a>
  <ul class="collapse">
  <li><a href="#importação-dos-dados-1" id="toc-importação-dos-dados-1" class="nav-link" data-scroll-target="#importação-dos-dados-1">Importação dos dados</a></li>
  <li><a href="#visualização-dos-dados-1" id="toc-visualização-dos-dados-1" class="nav-link" data-scroll-target="#visualização-dos-dados-1">Visualização dos dados</a></li>
  <li><a href="#anova-1" id="toc-anova-1" class="nav-link" data-scroll-target="#anova-1">ANOVA</a></li>
  <li><a href="#teste-de-tukey-1" id="toc-teste-de-tukey-1" class="nav-link" data-scroll-target="#teste-de-tukey-1">Teste de Tukey</a></li>
  <li><a href="#teste-de-normalidade" id="toc-teste-de-normalidade" class="nav-link" data-scroll-target="#teste-de-normalidade">Teste de normalidade</a></li>
  <li><a href="#teste-de-variância" id="toc-teste-de-variância" class="nav-link" data-scroll-target="#teste-de-variância">Teste de variância</a></li>
  <li><a href="#alternativa-1---transformação-de-dados" id="toc-alternativa-1---transformação-de-dados" class="nav-link" data-scroll-target="#alternativa-1---transformação-de-dados">Alternativa 1 - Transformação de dados</a>
  <ul class="collapse">
  <li><a href="#transformação-por-raiz-quadrada" id="toc-transformação-por-raiz-quadrada" class="nav-link" data-scroll-target="#transformação-por-raiz-quadrada">Transformação por raiz quadrada</a></li>
  <li><a href="#transformação-por-box-cox" id="toc-transformação-por-box-cox" class="nav-link" data-scroll-target="#transformação-por-box-cox">Transformação por Box-cox</a></li>
  </ul></li>
  <li><a href="#alternativa-2---não-paramétrico" id="toc-alternativa-2---não-paramétrico" class="nav-link" data-scroll-target="#alternativa-2---não-paramétrico">Alternativa 2 - Não paramétrico</a></li>
  <li><a href="#alternativa-3---glms" id="toc-alternativa-3---glms" class="nav-link" data-scroll-target="#alternativa-3---glms">Alternativa 3 - GLMs</a></li>
  </ul></li>
  <li><a href="#anova-fatorial" id="toc-anova-fatorial" class="nav-link" data-scroll-target="#anova-fatorial">ANOVA Fatorial</a>
  <ul class="collapse">
  <li><a href="#importação-dos-dados-2" id="toc-importação-dos-dados-2" class="nav-link" data-scroll-target="#importação-dos-dados-2">Importação dos dados</a></li>
  <li><a href="#visualização-dos-dados-2" id="toc-visualização-dos-dados-2" class="nav-link" data-scroll-target="#visualização-dos-dados-2">Visualização dos dados</a></li>
  <li><a href="#modelo-fatorial-2-way-anova" id="toc-modelo-fatorial-2-way-anova" class="nav-link" data-scroll-target="#modelo-fatorial-2-way-anova">Modelo fatorial (2-way ANOVA)</a></li>
  <li><a href="#teste-das-premissas-1" id="toc-teste-das-premissas-1" class="nav-link" data-scroll-target="#teste-das-premissas-1">Teste das premissas</a></li>
  <li><a href="#teste-de-comparação-das-médias" id="toc-teste-de-comparação-das-médias" class="nav-link" data-scroll-target="#teste-de-comparação-das-médias">Teste de comparação das médias</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ANOVA</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="teste-de-hipótese-de-três-ou-mais-grupos-independentes" class="level1">
<h1>Teste de hipótese de três ou mais grupos independentes</h1>
<p>A <strong>Análise de Variância (ou ANOVA)</strong> é uma técnica estatística usada para comparar a média de três ou mais grupos e determinar se há diferenças significativas entre eles.</p>
<p>No caso da ANOVA, as hipóteses formuladas são as seguintes: - <strong>Hipótese nula (Ho)</strong>: as médias dos grupos não diferem entre si - <strong>Hipótese alternativa (Ha)</strong>: pelo menos a média de um dos grupos difere das demais</p>
<p>Quando o conjunto de dados apresenta um único fator, a análise de variância realizada é denominada de <em>One-Way ANOVA</em> ou <em>ANOVA unifatorial</em>.</p>
<p>Quando o conjunto de dados apresenta dois fatores, a análise de variância realizada é denominada de <em>Two-Way ANOVA</em> ou <em>ANOVA fatorial</em>.</p>
<section id="importação-dos-dados" class="level2">
<h2 class="anchored" data-anchor-id="importação-dos-dados">Importação dos dados</h2>
<p>Usando a função <code>gsheet2tbl()</code> do pacote <code>gsheet</code>, foi importado um conjunto de dados envolvendo 5 grupos independentes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gsheet)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>micelial <span class="ot">&lt;-</span> <span class="fu">gsheet2tbl</span>(<span class="st">"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=959387827"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualização-dos-dados" class="level2">
<h2 class="anchored" data-anchor-id="visualização-dos-dados">Visualização dos dados</h2>
<p>Para a visualização dos dados, foi usada a função <code>ggplot()</code> juntamente com o <code>geom_jitter()</code>. Como o conjunto de dados possui apenas 6 repetições para cada grupo, é preferível usar o jitter que o boxplot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>micelial <span class="sc">|&gt;</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(especie, tcm))<span class="sc">+</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aula7_quarto_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Pode-se observar que há uma variabilidade visível entre os diferentes grupos, podendo inferir que uma das médias será diferente das demais.</p>
</section>
<section id="anova" class="level2">
<h2 class="anchored" data-anchor-id="anova">ANOVA</h2>
<p>Para executar uma análise de variância com o conjunto de dados trabalhado, o primeiro passo é ajustar os dados em um modelo linear. Esse ajuste é realiza através da função <code>lm()</code>, no qual a fórmula <code>tcm ~ especie</code> especifica que tcm (a variável resposta) está sendo modelada em função de especie (a variável preditora).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(tcm <span class="sc">~</span> especie, <span class="at">data =</span> micelial)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para exibir um resumo detalhado do modelo ajustado, pode ser utilizada a função <code>summary()</code>. Ela fornece as seguintes informações: - <strong>Coeficientes</strong>: Estimativas dos parâmetros do modelo (intercepto e coeficientes para cada nível de especie). - <strong>Erro padrão</strong>: Medida da precisão das estimativas dos coeficientes. - <strong>Estatística t e valor p</strong>: Usados para testar a hipótese nula de que cada coeficiente é igual a zero (sem efeito). - <strong>R^2 e R^2 ajustado</strong>: Medidas da qualidade do ajuste do modelo aos dados. - <strong>Estatística F</strong>: Teste global de significância do modelo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = tcm ~ especie, data = micelial)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.23667 -0.09667  0.01583  0.08833  0.28333 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.57167    0.05585  28.140  &lt; 2e-16 ***
especieFaus -0.33500    0.07899  -4.241 0.000266 ***
especieFcor -0.25000    0.07899  -3.165 0.004047 ** 
especieFgra -0.66000    0.07899  -8.356 1.05e-08 ***
especieFmer -0.14500    0.07899  -1.836 0.078317 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1368 on 25 degrees of freedom
Multiple R-squared:  0.7585,    Adjusted R-squared:  0.7199 
F-statistic: 19.63 on 4 and 25 DF,  p-value: 2.028e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Se quisermos fazer o summary sem interceptar uma espécie:</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(tcm <span class="sc">~</span> especie <span class="sc">-</span><span class="dv">1</span>, <span class="at">data =</span> micelial)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = tcm ~ especie - 1, data = micelial)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.23667 -0.09667  0.01583  0.08833  0.28333 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
especieFasi  1.57167    0.05585   28.14  &lt; 2e-16 ***
especieFaus  1.23667    0.05585   22.14  &lt; 2e-16 ***
especieFcor  1.32167    0.05585   23.66  &lt; 2e-16 ***
especieFgra  0.91167    0.05585   16.32 7.66e-15 ***
especieFmer  1.42667    0.05585   25.54  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1368 on 25 degrees of freedom
Multiple R-squared:  0.991, Adjusted R-squared:  0.9892 
F-statistic: 552.2 on 5 and 25 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Por fim, a análise de variância é executada usando a função <code>anova()</code>. Ela fornece as seguintes informações: - <strong>Df</strong>: Graus de liberdade associados ao modelo e aos resíduos. - <strong>Sum Sq</strong>: Soma dos quadrados (Soma dos quadrados do modelo e dos resíduos). - <strong>Mean Sq</strong>: Quadrados médios (Soma dos quadrados dividida pelos graus de liberdade correspondentes). - <strong>F value</strong>: Estatística F (razão dos quadrados médios do modelo e dos resíduos). - <strong>Pr(&gt;F)</strong>: Valor p associado à estatística F, usado para testar a hipótese nula de que todos os coeficientes (exceto o intercepto) são iguais a zero.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: tcm
          Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
especie    4 1.46958 0.36739  19.629 2.028e-07 ***
Residuals 25 0.46792 0.01872                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Como o p-valor foi inferior ao nível de significância (5%), podemos rejeitar a hipótese nula de que todos os grupos são iguais. Logo, pelo menos uma das médias difere estatisticamente das demais.</p>
<p>Contudo, através da ANOVA não é possível saber qual dos grupos difere das demais ou se há mais de um grupo que difere estatisticamente.</p>
</section>
<section id="teste-de-tukey" class="level2">
<h2 class="anchored" data-anchor-id="teste-de-tukey">Teste de Tukey</h2>
<p>Para saber qual média está se diferindo das demais, deve ser utilizado um teste de comparação de médias, como o Teste de Tukey.</p>
<p>Para realizar esse teste, primeiramente foi usada a função <code>emmeans()</code> do pacote <code>emmeans</code> para obter as médias da variável resposta em função das espécies (grupos).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>medias1 <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m1, <span class="sc">~</span> especie)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>medias1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> especie emmean     SE df lower.CL upper.CL
 Fasi     1.572 0.0559 25    1.457     1.69
 Faus     1.237 0.0559 25    1.122     1.35
 Fcor     1.322 0.0559 25    1.207     1.44
 Fgra     0.912 0.0559 25    0.797     1.03
 Fmer     1.427 0.0559 25    1.312     1.54

Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>Usando a função <code>cld()</code> e argumento <code>Letters = letters</code> dos pacotes <code>multcomp</code>e <code>multcompView</code>, é possível visualizar a diferença entre os grupos através do agrupamento das médias estatisticamente iguais representadas pela mesma letra.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcompView)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cld</span>(medias1, <span class="at">Letters =</span> letters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> especie emmean     SE df lower.CL upper.CL .group
 Fgra     0.912 0.0559 25    0.797     1.03  a    
 Faus     1.237 0.0559 25    1.122     1.35   b   
 Fcor     1.322 0.0559 25    1.207     1.44   b   
 Fmer     1.427 0.0559 25    1.312     1.54   bc  
 Fasi     1.572 0.0559 25    1.457     1.69    c  

Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 5 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
<p>Observando o resultado do Teste de Tukey, ocorreu a formação de 3 grupos estatisticamente distintos. Pode-se inferir que a espécie <em>Fgra</em> difere estatisticamente de todas as outras espécies. A espécie <em>Fasi</em> só não difere estatisticamente da espécie <em>Fmer</em>. As espécies <em>Faus</em> e <em>Fcor</em> não diferem entre si e não diferem de <em>Fmer</em>, mas diferem do resto das espécies.</p>
</section>
<section id="teste-das-premissas" class="level2">
<h2 class="anchored" data-anchor-id="teste-das-premissas">Teste das premissas</h2>
<p>Na Análise de Variância, as premissas de normalidade e de homocedasticidade também devem ser atendidas.</p>
<p>O teste de normalidade nesse caso é feito com os <em>residuals</em> (é cada diferença entre a média estimada e o valor original).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(m1<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aula7_quarto_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(m1<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  m1$residuals
W = 0.9821, p-value = 0.8782</code></pre>
</div>
</div>
<p>Observa-se que não rejeita a hipótese nula, ou seja, os dados são normais.</p>
<p>O teste de variância para três ou mais grupos independentes é feito com o Bartlett-test. Ele é executado usando a função <code>bartlett.test()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(tcm <span class="sc">~</span> especie, <span class="at">data =</span> micelial)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  tcm by especie
Bartlett's K-squared = 4.4367, df = 4, p-value = 0.3501</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Não rejeita a hipótese nula --&gt; são homogêneas</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nota-se que a hipótese nula não é rejeitada, indicando que as variâncias são homogêneas.</p>
<section id="checando-as-premissas-pelo-pacote-dharma" class="level3">
<h3 class="anchored" data-anchor-id="checando-as-premissas-pelo-pacote-dharma">Checando as premissas pelo pacote DHARMa</h3>
<p>Outra forma de checar se as premissas foram atendidas é através da função <code>simulateResiduals()</code> do pacote <code>DHARMa</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DHARMa)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">simulateResiduals</span>(m1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aula7_quarto_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>O gráfico da esquerda é um QQ plot dos <em>residuals</em>, ele compara a distribuição dos resíduos simulados com a distribuição teórica esperada (geralmente a normal). Os pontos devem seguir a linha diagonal. Desvios significativos da linha indicam que os resíduos não seguem a distribuição esperada, sugerindo que o modelo pode estar mal ajustado. Nesse caso não foi observado nenhum desvio.</p>
<p>O gráfico da direita mostra os resíduos simulados em função dos valores preditos pelo modelo. Para que a premissa da homocedasticidade seja atendida, não deve haver nenhum padrão evidente. Padrões ou tendências podem indicar falta de ajuste, variância não constante ou relações não modeladas entre as variáveis.</p>
</section>
<section id="checando-as-premissas-pelo-pacote-performance" class="level3">
<h3 class="anchored" data-anchor-id="checando-as-premissas-pelo-pacote-performance">Checando as premissas pelo pacote performance</h3>
<p>Outra forma de checar as premissas é através das funções <code>check_normality()</code> e <code>check_heteroscedasticity()</code> do pacote <code>performance</code>. Eles conferem se os dados apresentam distribuição normal e variâncias homogêneas de forma automática.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">check_normality</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OK: residuals appear as normally distributed (p = 0.878).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_heteroscedasticity</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OK: Error variance appears to be homoscedastic (p = 0.880).</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="anova-de-dados-não-paramétricos" class="level1">
<h1>ANOVA de dados não-paramétricos</h1>
<p>Ao realizar uma análise de variância, as premissas de normalidade e de homocedasticidade podem não ser atendidas. Nesse caso, é necessário adotar algumas medidas para resolver a análise.</p>
<p>Existem 3 alternativas que podem ser adotadas para que as premissas sejam atendidas: - <strong>Transformação dos dados</strong> - <strong>Teste não-paramétrico</strong> - <strong>GLM</strong></p>
<section id="importação-dos-dados-1" class="level2">
<h2 class="anchored" data-anchor-id="importação-dos-dados-1">Importação dos dados</h2>
<p>Foi importando um dataframe nativo do R, denominado de <code>InsectSprays</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>inseticida <span class="ot">&lt;-</span> InsectSprays</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para contar quantos inseticidas diferentes foram usados, foi executado a função <code>count()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>inseticida <span class="sc">|&gt;</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(spray)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  spray  n
1     A 12
2     B 12
3     C 12
4     D 12
5     E 12
6     F 12</code></pre>
</div>
</div>
</section>
<section id="visualização-dos-dados-1" class="level2">
<h2 class="anchored" data-anchor-id="visualização-dos-dados-1">Visualização dos dados</h2>
<p>Para visualizar os dados, foi criado um gráfico de boxplot e de pontos usando as funções <code>ggplot()</code>, <code>geom_boxplot()</code> e <code>geom_jitter()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>inseticida <span class="sc">|&gt;</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(spray, count))<span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.05</span>)<span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aula7_quarto_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Pela assimetria dos boxplots e pela suas estruturas, já é possível prever que o conjunto de dados não atende as premissas de normalidade e homocedasticidade.</p>
</section>
<section id="anova-1" class="level2">
<h2 class="anchored" data-anchor-id="anova-1">ANOVA</h2>
<p>Para realizar a análise de variância, os dados foram ajustado ao modelo linear pela função <code>lm()</code> e foi executado a <code>anova()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(count <span class="sc">~</span> spray, <span class="at">data =</span> inseticida)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = count ~ spray, data = inseticida)

Residuals:
   Min     1Q Median     3Q    Max 
-8.333 -1.958 -0.500  1.667  9.333 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  14.5000     1.1322  12.807  &lt; 2e-16 ***
sprayB        0.8333     1.6011   0.520    0.604    
sprayC      -12.4167     1.6011  -7.755 7.27e-11 ***
sprayD       -9.5833     1.6011  -5.985 9.82e-08 ***
sprayE      -11.0000     1.6011  -6.870 2.75e-09 ***
sprayF        2.1667     1.6011   1.353    0.181    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.922 on 66 degrees of freedom
Multiple R-squared:  0.7244,    Adjusted R-squared:  0.7036 
F-statistic:  34.7 on 5 and 66 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: count
          Df Sum Sq Mean Sq F value    Pr(&gt;F)    
spray      5 2668.8  533.77  34.702 &lt; 2.2e-16 ***
Residuals 66 1015.2   15.38                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Com o p-valor inferior ao nível de significância, a hipótese nula é rejeitada.</p>
</section>
<section id="teste-de-tukey-1" class="level2">
<h2 class="anchored" data-anchor-id="teste-de-tukey-1">Teste de Tukey</h2>
<p>Em seguida foi usado o Teste de Tukey para comparação das médias entre os grupos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>m2_medias <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m2, <span class="sc">~</span> spray)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m2_medias)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aula7_quarto_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cld</span>(m2_medias, <span class="at">Letters =</span> letters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> spray emmean   SE df lower.CL upper.CL .group
 C       2.08 1.13 66   -0.177     4.34  a    
 E       3.50 1.13 66    1.240     5.76  a    
 D       4.92 1.13 66    2.656     7.18  a    
 A      14.50 1.13 66   12.240    16.76   b   
 B      15.33 1.13 66   13.073    17.59   b   
 F      16.67 1.13 66   14.406    18.93   b   

Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 6 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
<p>Pelo resultado do teste nota-se que existem dois grupos estatisticamente diferentes. Sendo que os inseticidas C, E e D não diferem entre si, mas diferem de A, B e F (que por sua vez não diferem entre si).</p>
<p>Tanto a Análise de Variância quanto o Teste de Tukey foram executados, no entanto, para que essas análises sejam considerados válidos, é necessário conferir se o conjunto de dados atende às premissas de normalidade e de homocedasticidade.</p>
</section>
<section id="teste-de-normalidade" class="level2">
<h2 class="anchored" data-anchor-id="teste-de-normalidade">Teste de normalidade</h2>
<p>O teste de normalidade foi executado por meio do Shapiro-test com os resíduos através da função <code>shapiro.test()</code>. Também foi usado <code>qqnorm()</code> e <code>qqline()</code> para visualizar a normalidade por meio de gráfico.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(m2<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aula7_quarto_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(m2<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  m2$residuals
W = 0.96006, p-value = 0.02226</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(m2<span class="sc">$</span>residuals)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(m2<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aula7_quarto_files/figure-html/unnamed-chunk-17-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>O Shapiro-test forneceu um p-valor inferior ao nível de significância, rejeitando a hipótese nula de que o dado segue uma distribuição normal, ou seja, os dados não apresentam normalidade.</p>
<p>O gráfico criado também demonstra desvios em relação à reta, o que indica a não normalidade.</p>
</section>
<section id="teste-de-variância" class="level2">
<h2 class="anchored" data-anchor-id="teste-de-variância">Teste de variância</h2>
<p>O teste de variância foi executado com a função <code>bartlett.test()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(count <span class="sc">~</span> spray, <span class="at">data =</span> inseticida)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  count by spray
Bartlett's K-squared = 25.96, df = 5, p-value = 9.085e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Rejeitamos a homogeneicidade entre as variâncias</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Observa-se que o p-valor é inferior a 5%, rejeitando a hipótese nula de que as variâncias são homogêneas.</p>
<p>Usando as funções <code>check_normality()</code> e <code>check_heteroscedasticity()</code>, observa-se os mesmos resultados.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_normality</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Warning: Non-normality of residuals detected (p = 0.022).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_heteroscedasticity</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Warning: Heteroscedasticity (non-constant error variance) detected (p &lt; .001).</code></pre>
</div>
</div>
<p>A função <code>simulateResiduals()</code> também indica a falta de homocedasticidade dos dados, embora não indique a falta de normalidade.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">simulateResiduals</span>(m2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aula7_quarto_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Não atendendo as duas premissas, esse conjunto de dados precisa ser manipulado para que as premissas sejam atendidas e o resultado de sua análise seja válido.</p>
</section>
<section id="alternativa-1---transformação-de-dados" class="level2">
<h2 class="anchored" data-anchor-id="alternativa-1---transformação-de-dados">Alternativa 1 - Transformação de dados</h2>
<p>Uma medida que pode ser adotada para que os dados atendam as premissas é a transformação dos dados.</p>
<p>Os dados podem ser transformados de diversas formas, mas os principais são por raiz quadrada, por log(x) e por box-cox.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Pode ser usado log(x + 0.5) ao invés de log(x) quando existe um valor igual a 0 nas variáveis respostas.</p>
</div>
</div>
<section id="transformação-por-raiz-quadrada" class="level3">
<h3 class="anchored" data-anchor-id="transformação-por-raiz-quadrada">Transformação por raiz quadrada</h3>
<p>Uma nova coluna com os valores transformados será criado para o conjunto de dados usando a função <code>mutate()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>inseticida <span class="ot">&lt;-</span> inseticida <span class="sc">|&gt;</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">count2 =</span> <span class="fu">sqrt</span>(count))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Visualizando os novos dados, é possível notar as alterações.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>inseticida <span class="sc">|&gt;</span> </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(spray, count2))<span class="sc">+</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aula7_quarto_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Com os dados transformados, será realizado uma nova análise de variância para observar se houve alguma mudança.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(count2 <span class="sc">~</span> spray,</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> inseticida)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = count2 ~ spray, data = inseticida)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.24486 -0.39970 -0.01902  0.42661  1.40089 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   3.7607     0.1814  20.733  &lt; 2e-16 ***
sprayB        0.1160     0.2565   0.452    0.653    
sprayC       -2.5158     0.2565  -9.807 1.64e-14 ***
sprayD       -1.5963     0.2565  -6.223 3.80e-08 ***
sprayE       -1.9512     0.2565  -7.606 1.34e-10 ***
sprayF        0.2579     0.2565   1.006    0.318    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6283 on 66 degrees of freedom
Multiple R-squared:  0.7724,    Adjusted R-squared:  0.7552 
F-statistic:  44.8 on 5 and 66 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: count2
          Df Sum Sq Mean Sq F value    Pr(&gt;F)    
spray      5 88.438 17.6876  44.799 &lt; 2.2e-16 ***
Residuals 66 26.058  0.3948                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>A análise continua rejeitando a hipótese nula. Em seguida foi comparado as médias entre os grupos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>m3_medias <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m3, <span class="sc">~</span> spray)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m3_medias)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aula7_quarto_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cld</span>(m3_medias, <span class="at">Letters =</span> letters) <span class="co">#Os dados transformados discriminou melhor, separou mais</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> spray emmean    SE df lower.CL upper.CL .group
 C       1.24 0.181 66    0.883     1.61  a    
 E       1.81 0.181 66    1.447     2.17  ab   
 D       2.16 0.181 66    1.802     2.53   b   
 A       3.76 0.181 66    3.399     4.12    c  
 B       3.88 0.181 66    3.514     4.24    c  
 F       4.02 0.181 66    3.656     4.38    c  

Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 6 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
<p>Observa-se que dessa vez foram criados 3 grupos estatisticamente distintos, o que significa que os dados transformados discriminou melhor os grupos.</p>
<p>Outra forma de observar a comparação das médias entre grupos é pela função <code>pwpm()</code>, que permite a comparação entre cada grupo, um por um. A função <code>pwpp()</code> mostra a comparação entre grupos através de um gráfico. A função <code>pairs()</code> compara os grupos par por par.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwpm</span>(m3_medias)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       A      B      C      D      E      F
A [3.76] 0.9975 &lt;.0001 &lt;.0001 &lt;.0001 0.9145
B -0.116 [3.88] &lt;.0001 &lt;.0001 &lt;.0001 0.9936
C  2.516  2.632 [1.24] 0.0081 0.2513 &lt;.0001
D  1.596  1.712 -0.919 [2.16] 0.7366 &lt;.0001
E  1.951  2.067 -0.565  0.355 [1.81] &lt;.0001
F -0.258 -0.142 -2.774 -1.854 -2.209 [4.02]

Row and column labels: spray
Upper triangle: P values   adjust = "tukey"
Diagonal: [Estimates] (emmean) 
Lower triangle: Comparisons (estimate)   earlier vs. later</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwpp</span>(m3_medias)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aula7_quarto_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(m3_medias)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast estimate    SE df t.ratio p.value
 A - B      -0.116 0.257 66  -0.452  0.9975
 A - C       2.516 0.257 66   9.807  &lt;.0001
 A - D       1.596 0.257 66   6.223  &lt;.0001
 A - E       1.951 0.257 66   7.606  &lt;.0001
 A - F      -0.258 0.257 66  -1.006  0.9145
 B - C       2.632 0.257 66  10.259  &lt;.0001
 B - D       1.712 0.257 66   6.675  &lt;.0001
 B - E       2.067 0.257 66   8.058  &lt;.0001
 B - F      -0.142 0.257 66  -0.554  0.9936
 C - D      -0.919 0.257 66  -3.584  0.0081
 C - E      -0.565 0.257 66  -2.201  0.2513
 C - F      -2.774 0.257 66 -10.813  &lt;.0001
 D - E       0.355 0.257 66   1.383  0.7366
 D - F      -1.854 0.257 66  -7.229  &lt;.0001
 E - F      -2.209 0.257 66  -8.612  &lt;.0001

P value adjustment: tukey method for comparing a family of 6 estimates </code></pre>
</div>
</div>
<p>As premissas são conferidas novamente para observar se houve mudança com a transformação dos dados.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(m3<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aula7_quarto_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(m3<span class="sc">$</span>residuals)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(m3<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aula7_quarto_files/figure-html/unnamed-chunk-26-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(m3<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  m3$residuals
W = 0.98721, p-value = 0.6814</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(count2 <span class="sc">~</span> spray,</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> inseticida)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  count2 by spray
Bartlett's K-squared = 3.7525, df = 5, p-value = 0.5856</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_normality</span>(m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OK: residuals appear as normally distributed (p = 0.681).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_heteroscedasticity</span>(m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OK: Error variance appears to be homoscedastic (p = 0.854).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">simulateResiduals</span>(m3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aula7_quarto_files/figure-html/unnamed-chunk-26-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>As duas premissas foram atendidas, dando validade à análise de variância realizada.</p>
</section>
<section id="transformação-por-box-cox" class="level3">
<h3 class="anchored" data-anchor-id="transformação-por-box-cox">Transformação por Box-cox</h3>
<p>Outra forma de transformar os dados é através do Box-cox. Para essa transformação, é preciso encontrar o valor de lambda (<span class="math inline">\(\lambda\)</span>), extraído a partir da função <code>boxcox()</code> do pacote <code>MASS</code>. Essa função calcula a verossimilhança perfilhada do parâmetro <span class="math inline">\(\lambda\)</span>. Devemos escolher o valor que maximiza esta função.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">boxcox</span>(<span class="fu">lm</span>(inseticida<span class="sc">$</span>count<span class="fl">+0.1</span> <span class="sc">~</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aula7_quarto_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> b<span class="sc">$</span>x[<span class="fu">which.max</span>(b<span class="sc">$</span>y)]</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>lambda</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4242424</code></pre>
</div>
</div>
<p>Encontrado o valor de <span class="math inline">\(\lambda\)</span>, uma nova coluna será adicionada ao conjunto de dados com os novos dados transformados.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>inseticida<span class="sc">$</span>count3 <span class="ot">&lt;-</span> (inseticida<span class="sc">$</span>count <span class="sc">^</span> lambda <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span> lambda</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>inseticida<span class="sc">$</span>count3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  3.903635  3.024469  6.043993  4.864268  4.864268  4.407118  3.903635
 [8]  6.557185  5.484274  6.043993  4.864268  4.640760  4.161975  5.484274
[15]  6.219699  4.161975  5.285168  4.864268  5.484274  5.484274  5.863153
[22]  6.219699  3.024469  4.640760 -2.357143  0.000000  3.024469  0.805831
[29]  1.399509  0.000000  0.805831  0.000000  1.399509 -2.357143  0.000000
[36]  1.887150  1.399509  2.308577  4.407118  2.683787  1.887150  1.399509
[43]  2.308577  2.308577  2.308577  2.308577  0.805831  1.887150  1.399509
[50]  2.308577  1.399509  2.308577  1.399509  2.683787  0.000000  0.000000
[57]  1.399509  0.805831  2.683787  1.887150  4.161975  3.629951  5.078760
[64]  6.390651  5.078760  5.285168  4.640760  3.903635  7.033117  7.033117
[71]  6.719601  4.640760</code></pre>
</div>
</div>
<p>Depois de transformados, devem ser realizados os mesmos passos da análise de variância com os novos dados.</p>
</section>
</section>
<section id="alternativa-2---não-paramétrico" class="level2">
<h2 class="anchored" data-anchor-id="alternativa-2---não-paramétrico">Alternativa 2 - Não paramétrico</h2>
<p>Outra alternativa para se trabalhar com dados que não atendem as premissas é realizando um teste não-paramétrico. Dessa forma é analisado os dados originais, sem passar por transformação.</p>
<p>A alternativa não-paramétrica para a ANOVA é o teste de <strong>Kruscal-Wallis</strong>. O teste de Kruscal-Wallis é o teste não paramétrico utilizado na comparação de três ou mais amostras independentes. Ele nos indica se há diferença entre pelo menos dois deles. A aplicação do teste utiliza os valores numéricos transformados em postos (rankings) e agrupados num só conjunto de dados. A comparação dos grupos é realizada por meio da média dos postos (posto médio).</p>
<p>Para executar esse teste, é necessário utiliza a função <code>kruskal.test()</code> do pacote <code>agricolae</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(count <span class="sc">~</span> spray,</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> inseticida)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  count by spray
Kruskal-Wallis chi-squared = 54.691, df = 5, p-value = 1.511e-10</code></pre>
</div>
</div>
<p>Observa-se que o p-valor foi inferior ao nível de significância, rejeitando a hipótese nula de que os grupos são iguais.</p>
<p>A comparação da média entre os grupos também pode ser realizado usando a função <code>kruskal()</code> e o argumento <code>group = TRUE</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> <span class="fu">kruskal</span>(inseticida<span class="sc">$</span>count, </span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>              inseticida<span class="sc">$</span>spray, </span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">group =</span> <span class="cn">TRUE</span>)</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>m4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$statistics
     Chisq Df      p.chisq  t.value      MSD
  54.69134  5 1.510845e-10 1.996564 8.462804

$parameters
            test p.ajusted           name.t ntr alpha
  Kruskal-Wallis      none inseticida$spray   6  0.05

$means
  inseticida.count     rank      std  r Min Max   Q25  Q50   Q75
A        14.500000 52.16667 4.719399 12   7  23 11.50 14.0 17.75
B        15.333333 54.83333 4.271115 12   7  21 12.50 16.5 17.50
C         2.083333 11.45833 1.975225 12   0   7  1.00  1.5  3.00
D         4.916667 25.58333 2.503028 12   2  12  3.75  5.0  5.00
E         3.500000 19.33333 1.732051 12   1   6  2.75  3.0  5.00
F        16.666667 55.62500 6.213378 12   9  26 12.50 15.0 22.50

$comparison
NULL

$groups
  inseticida$count groups
F         55.62500      a
B         54.83333      a
A         52.16667      a
D         25.58333      b
E         19.33333     bc
C         11.45833      c

attr(,"class")
[1] "group"</code></pre>
</div>
</div>
<p>Nota-se que os grupos formados são o mesmo da alternativa 1.</p>
</section>
<section id="alternativa-3---glms" class="level2">
<h2 class="anchored" data-anchor-id="alternativa-3---glms">Alternativa 3 - GLMs</h2>
<p>Os <strong>modelos lineares generalizados (GLMs)</strong> são uma ampliação dos modelos lineares ordinários. Os GLM’s são usados quando os resíduos (erro) do modelo apresentam distribuição diferente da normal (gaussiana).</p>
<p>No GLMs, deve-se especificar a distribuição de frequência que deseja utilizar para modelar a variável resposta. Esta distribuição de frequência deve pertencer à família exponencial, que inclui a distribuição de Poisson, Gaussiana, Binomial, Binomial negativa, Gamma, Bernoulli e Beta.</p>
<p>Se Y é uma variável contínua, a sua distribuição de probabilidade deve ser normal. Nesses casos as distribuições recomendadas são a <strong>Gaussiana (Normal)</strong> ou <strong>Gamma</strong>. Se Y é uma variável de proporção que varia continuamente entre 0 e 1 ou 0 e 100, mas não inclui 0 nem 1, a distribuição recomendada é a <strong>Beta</strong>.</p>
<p>Se Y é binário (e.g., vivo ou morto), a distribuição de probabilidade deve ser <strong>Binomial</strong>. Se Y é uma contagem (e.g., abundância ou riqueza de espécies), então a distribuição de probabilidade deve ser <strong>Poisson</strong> ou <strong>Binomial Negativa</strong>.</p>
<p>No caso do conjunto de dados trabalhado, a variável Y representa uma contagem, o que permite utilizar a família Poisson. Para executar o ajuste do modelo, é utilizado a função <code>glm()</code> com o argumento <code>family = poisson</code>.</p>
<p>Tendo o modelo ajustado, são repetidos os mesmos passos de uma análise de variância normal. A única diferença é que ao invés de usar a função <code>anova()</code>, recomenda-se usar a função <code>Anova()</code> do pacote <code>car</code>, pois ele fornece diretamente o p-valor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>m5 <span class="ot">&lt;-</span> <span class="fu">glm</span>(count <span class="sc">~</span> spray,</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">family =</span> poisson,</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> inseticida)</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = count ~ spray, family = poisson, data = inseticida)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  2.67415    0.07581  35.274  &lt; 2e-16 ***
sprayB       0.05588    0.10574   0.528    0.597    
sprayC      -1.94018    0.21389  -9.071  &lt; 2e-16 ***
sprayD      -1.08152    0.15065  -7.179 7.03e-13 ***
sprayE      -1.42139    0.17192  -8.268  &lt; 2e-16 ***
sprayF       0.13926    0.10367   1.343    0.179    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 409.041  on 71  degrees of freedom
Residual deviance:  98.329  on 66  degrees of freedom
AIC: 376.59

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model: poisson, link: log

Response: count

Terms added sequentially (first to last)

      Df Deviance Resid. Df Resid. Dev
NULL                     71     409.04
spray  5   310.71        66      98.33</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(m5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II tests)

Response: count
      LR Chisq Df Pr(&gt;Chisq)    
spray   310.71  5  &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Observa-se que o p-valor foi inferior ao nível de significância, rejeitando a hipótese nula de que os grupos são iguais.</p>
<p>As premissas podem ser conferidas através da função <code>simulateResiduals()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">simulateResiduals</span>(m5))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aula7_quarto_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Embora a normalidade não foi atendida, a premissa da homocedasticidade tem maior peso.</p>
<p>O teste de comparação das médias foi executado através do <code>emmeans()</code> e <code>cld()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>m5_medias <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m5, <span class="sc">~</span> spray,</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>m5_medias</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> spray  rate    SE  df asymp.LCL asymp.UCL
 A     14.50 1.099 Inf     12.50     16.82
 B     15.33 1.130 Inf     13.27     17.72
 C      2.08 0.417 Inf      1.41      3.08
 D      4.92 0.640 Inf      3.81      6.35
 E      3.50 0.540 Inf      2.59      4.74
 F     16.67 1.179 Inf     14.51     19.14

Confidence level used: 0.95 
Intervals are back-transformed from the log scale </code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cld</span>(m5_medias)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> spray  rate    SE  df asymp.LCL asymp.UCL .group
 C      2.08 0.417 Inf      1.41      3.08  1    
 E      3.50 0.540 Inf      2.59      4.74  12   
 D      4.92 0.640 Inf      3.81      6.35   2   
 A     14.50 1.099 Inf     12.50     16.82    3  
 B     15.33 1.130 Inf     13.27     17.72    3  
 F     16.67 1.179 Inf     14.51     19.14    3  

Confidence level used: 0.95 
Intervals are back-transformed from the log scale 
P value adjustment: tukey method for comparing a family of 6 estimates 
Tests are performed on the log scale 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
<p>As 3 alternativas deram o mesmo resultado, mas o GLMs é o mais utilizado pelo fato dele não precisar transformar os dados de maneira nenhuma e permitir o uso da ANOVA.</p>
</section>
</section>
<section id="anova-fatorial" class="level1">
<h1>ANOVA Fatorial</h1>
<p>Quando o conjunto de dados apresenta dois fatores, a análise realizada é a ANOVA fatorial.</p>
<p>Na ANOVA fatorial ou Two-Way ANOVA, são formulados 6 hipóteses, sendo 3 hipóteses nulas e 3 hipóteses alternativas:</p>
<ul>
<li><strong>Hipótese nula 1 (Ho1)</strong>: não há diferença entre os grupos em função do fator A.</li>
<li><strong>Hipótese alternativa 1 (Ha1)</strong>: há pelo menos uma diferença entre os grupos em função do fator A.</li>
<li><strong>Hipótese nula 2 (Ho2)</strong>: não há diferença entre os grupos em função do fator B.</li>
<li><strong>Hipótese alternativa 2 (Ha2)</strong>: há pelo menos uma diferença entre os grupos em função do fator B.</li>
<li><strong>Hipótese nula 3 (Ho3)</strong>: não há interação entre fator A e fator B. O efeito do fator A nas médias dos grupos é o mesmo para todos os níveis do fator B.</li>
<li><strong>Hipótese alternativa 3 (Ha3)</strong>: existe uma interação entre fator A e B. O efeito do fator A nas médias dos grupos depende dos níveis do fator B.</li>
</ul>
<section id="importação-dos-dados-2" class="level2">
<h2 class="anchored" data-anchor-id="importação-dos-dados-2">Importação dos dados</h2>
<p>Os dados foram importados do Google Sheets pela função <code>gsheet2tbl()</code> do pacote <code>gsheet</code>. O conjunto de dados avalia a severidade de uma doença em função de dois fatores: o tipo de tratamento aplicado e as doses do tratamento.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>li <span class="ot">&lt;-</span> <span class="fu">gsheet2tbl</span>(<span class="st">"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=2023059672"</span>)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>li</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 8
   treat         dose   rep  n_sp dis_sp n_seeds inf_seeds severity
   &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
 1 Ionic liquid   0.5     1   103     13      25        10   0.126 
 2 Ionic liquid   0.5     2   125     31      25        12   0.248 
 3 Ionic liquid   0.5     3   210     80      25        12   0.381 
 4 Ionic liquid   0.5     4    97     28      25        10   0.289 
 5 Ionic liquid   0.5     5   180     75      25        11   0.417 
 6 Ionic liquid   2       2   116      9      25         6   0.0776
 7 Ionic liquid   2       3   166      7      25         3   0.0422
 8 Ionic liquid   2       4   157     12      25         1   0.0764
 9 Ionic liquid   2       5   129      7      25         7   0.0543
10 Ionic liquid   2       1    84      0      25         1   0     
11 Tebuconazole   0.5     1   121      0      25         2   0     
12 Tebuconazole   0.5     2   123      6      25         5   0.0488
13 Tebuconazole   0.5     3   107      3      25         1   0.0280
14 Tebuconazole   0.5     4    90      0      25         2   0     
15 Tebuconazole   0.5     5   142      4      25         1   0.0282
16 Tebuconazole   2       1   166      3      25         5   0.0181
17 Tebuconazole   2       2   120      0      25         2   0     
18 Tebuconazole   2       3   100      4      25         2   0.04  
19 Tebuconazole   2       4    96      3      25         0   0.0312
20 Tebuconazole   2       5   170      2      25         4   0.0118</code></pre>
</div>
</div>
</section>
<section id="visualização-dos-dados-2" class="level2">
<h2 class="anchored" data-anchor-id="visualização-dos-dados-2">Visualização dos dados</h2>
<p>Como o número de repetições é baixo, o conjunto de dados será visualizado com um gráfico de pontos usando a função <code>ggplot()</code> juntamente a <code>geom_jitter()</code>. A função <code>facet_wrap()</code> foi usada para dividir os dados em função do tratamento aplicado.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>li <span class="sc">|&gt;</span> </span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">factor</span>(dose), severity, <span class="at">color =</span> <span class="fu">factor</span>(dose)))<span class="sc">+</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>treat)<span class="sc">+</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aula7_quarto_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="modelo-fatorial-2-way-anova" class="level2">
<h2 class="anchored" data-anchor-id="modelo-fatorial-2-way-anova">Modelo fatorial (2-way ANOVA)</h2>
<p>A função utilizada para o ajuste do modelo linear é a mesma: <code>lm()</code>. No entanto, como se trata de dois fatores envolvidos (treat e dose), a fórmula usada é <code>severity ~ treat*factor(dose)</code>. O grupo <em>dose</em> foi especificado como um fator para que ele não fosse considerado como uma variável numérica.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>mf <span class="ot">&lt;-</span> <span class="fu">lm</span>(severity <span class="sc">~</span> treat<span class="sc">*</span><span class="fu">factor</span>(dose),</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> li)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>mf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = severity ~ treat * factor(dose), data = li)

Coefficients:
                    (Intercept)                treatTebuconazole  
                         0.2921                          -0.2711  
                  factor(dose)2  treatTebuconazole:factor(dose)2  
                        -0.2420                           0.2412  </code></pre>
</div>
</div>
<p>Com o modelo linear ajustado, foi feito a ANOVA usando a função <code>anova()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: severity
                   Df   Sum Sq  Mean Sq F value    Pr(&gt;F)    
treat               1 0.113232 0.113232  30.358 4.754e-05 ***
factor(dose)        1 0.073683 0.073683  19.755 0.0004077 ***
treat:factor(dose)  1 0.072739 0.072739  19.502 0.0004326 ***
Residuals          16 0.059678 0.003730                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Em relação ao fator tratamento, observa-se que o p-valor foi inferior ao nível de significância (5%), rejeitando a hipótese nula de que os grupos são iguais em função do tratamento aplicado.</p>
<p>Também nota-se que em relação ao fator dose, o p-valor foi inferior ao nível de significância (5%), rejeitando a hipótese nula de que os grupos são iguais em função das doses aplicadas.</p>
<p>Por último também foi visto que a interação entre os fatores “tratamento” e “dose” foi significativo, indicando que a interação entre esses dois fatores interferem nas diferenças estatísticas entre os grupos.</p>
</section>
<section id="teste-das-premissas-1" class="level2">
<h2 class="anchored" data-anchor-id="teste-das-premissas-1">Teste das premissas</h2>
<p>As premissas foram checadas através das funções <code>simulateResiduals()</code>, <code>check_normality()</code> e <code>check_heteroscedasticity()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">simulateResiduals</span>(mf))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aula7_quarto_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_normality</span>(mf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Warning: Non-normality of residuals detected (p = 0.011).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_heteroscedasticity</span>(mf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Warning: Heteroscedasticity (non-constant error variance) detected (p &lt; .001).</code></pre>
</div>
</div>
<p>As funções do pacote <code>performance</code> apresentaram problemas em relação à normalidade e homocedasticidade, no entanto, a função <code>simulateResiduals()</code> não demonstrou problema nas premissas.</p>
</section>
<section id="teste-de-comparação-das-médias" class="level2">
<h2 class="anchored" data-anchor-id="teste-de-comparação-das-médias">Teste de comparação das médias</h2>
<p>Em seguida, foi feito a comparação entre as médias dos grupos usando as funções <code>emmeans()</code> e <code>cld()</code>.</p>
<p>Por se tratar de dois fatores, foi comparado as médias entre os grupos em função de cada fator, usando as fórmulas <code>~ treat|dose</code> para comparar as médias dos tratamentos em função das doses e <code>~ dose|treat</code> para comparar as médias das doses em função dos tratamentos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>mf_medias <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(mf, <span class="sc">~</span> treat<span class="sc">|</span>dose)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>mf_medias</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>dose = 0.5:
 treat        emmean     SE df lower.CL upper.CL
 Ionic liquid 0.2921 0.0273 16  0.23420   0.3500
 Tebuconazole 0.0210 0.0273 16 -0.03690   0.0789

dose = 2.0:
 treat        emmean     SE df lower.CL upper.CL
 Ionic liquid 0.0501 0.0273 16 -0.00781   0.1080
 Tebuconazole 0.0202 0.0273 16 -0.03768   0.0781

Confidence level used: 0.95 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cld</span>(mf_medias, <span class="at">Letters =</span> letters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>dose = 0.5:
 treat        emmean     SE df lower.CL upper.CL .group
 Tebuconazole 0.0210 0.0273 16 -0.03690   0.0789  a    
 Ionic liquid 0.2921 0.0273 16  0.23420   0.3500   b   

dose = 2.0:
 treat        emmean     SE df lower.CL upper.CL .group
 Tebuconazole 0.0202 0.0273 16 -0.03768   0.0781  a    
 Ionic liquid 0.0501 0.0273 16 -0.00781   0.1080  a    

Confidence level used: 0.95 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cld</span>(mf_medias))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aula7_quarto_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>mf_medias2 <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(mf, <span class="sc">~</span>dose<span class="sc">|</span>treat)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cld</span>(mf_medias2, <span class="at">Letters =</span> letters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>treat = Ionic liquid:
 dose emmean     SE df lower.CL upper.CL .group
  2.0 0.0501 0.0273 16 -0.00781   0.1080  a    
  0.5 0.2921 0.0273 16  0.23420   0.3500   b   

treat = Tebuconazole:
 dose emmean     SE df lower.CL upper.CL .group
  2.0 0.0202 0.0273 16 -0.03768   0.0781  a    
  0.5 0.0210 0.0273 16 -0.03690   0.0789  a    

Confidence level used: 0.95 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cld</span>(mf_medias2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aula7_quarto_files/figure-html/unnamed-chunk-39-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Na montagem de uma tabela de comparação das médias entre os grupos, as letras maiúsculas são usadas para comparar as mesmas colunas, enquanto que as letras minúsculas são usadas para comparar as mesmas linhas</p>
</div>
</div>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>